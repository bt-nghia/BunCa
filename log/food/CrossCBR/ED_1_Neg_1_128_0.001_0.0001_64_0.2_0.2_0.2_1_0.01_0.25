{'data_path': './datasets', 'batch_size_train': 128, 'batch_size_test': 128, 'topk': [1, 2, 3, 4, 5], 'neg_num': 1, 'aug_type': 'ED', 'ed_interval': 1, 'embedding_sizes': [64], 'num_layerss': [1], 'item_level_ratios': [0.2], 'bundle_level_ratios': [0.2], 'bundle_agg_ratios': [0.2], 'self_loop': False, 'lrs': [0.001], 'l2_regs': [0.0001], 'c_lambdas': [0.01], 'c_temps': [0.25], 'epochs': 30, 'UI_layers': [0.7, 0.3], 'seed': 2023, 'UB_coefs': [1, 1], 'UI_coefs': [1, 1], 'BI_coefs': [1, 1], 'sep': '\t', 'file_type': '.txt', 'topk_valid': 3, 'nhead': 2, 'extra_layer': True, 'dataset': 'food', 'model': 'CrossCBR', 'gpu': '0', 'info': '', 'num_users': 879, 'num_bundles': 1784, 'num_items': 3767, 'w1': 1.0, 'w2': 1.0, 'w3': 0.1, 'w4': 0.1, 'sw': 0.9, 'nw': 0.8, 'device': device(type='cpu'), 'l2_reg': 0.0001, 'embedding_size': 64, 'item_level_ratio': 0.2, 'bundle_level_ratio': 0.2, 'bundle_agg_ratio': 0.2, 'num_layers': 1, 'c_lambda': 0.01, 'c_temp': 0.25}
2023-11-26 17:38:29, Top_1, Val:  recall: 0.073394, ndcg: 0.073394
2023-11-26 17:38:29, Top_1, Test: recall: 0.073394, ndcg: 0.073394
2023-11-26 17:38:29, Top_2, Val:  recall: 0.123853, ndcg: 0.105230
2023-11-26 17:38:29, Top_2, Test: recall: 0.119266, ndcg: 0.102336
2023-11-26 17:38:29, Top_3, Val:  recall: 0.201835, ndcg: 0.144221
2023-11-26 17:38:29, Top_3, Test: recall: 0.197248, ndcg: 0.141327
2023-11-26 17:38:29, Top_4, Val:  recall: 0.224771, ndcg: 0.154099
2023-11-26 17:38:29, Top_4, Test: recall: 0.229358, ndcg: 0.155156
2023-11-26 17:38:29, Top_5, Val:  recall: 0.261468, ndcg: 0.168296
2023-11-26 17:38:29, Top_5, Test: recall: 0.298165, ndcg: 0.181774
2023-11-26 17:38:29, Best in epoch 0, TOP 1: REC_V=0.07339, NDCG_V=0.07339
2023-11-26 17:38:29, Best in epoch 0, TOP 1: REC_T=0.07339, NDCG_T=0.07339
2023-11-26 17:38:29, Best in epoch 0, TOP 2: REC_V=0.12385, NDCG_V=0.10523
2023-11-26 17:38:29, Best in epoch 0, TOP 2: REC_T=0.11927, NDCG_T=0.10234
2023-11-26 17:38:29, Best in epoch 0, TOP 3: REC_V=0.20183, NDCG_V=0.14422
2023-11-26 17:38:29, Best in epoch 0, TOP 3: REC_T=0.19725, NDCG_T=0.14133
2023-11-26 17:38:29, Best in epoch 0, TOP 4: REC_V=0.22477, NDCG_V=0.15410
2023-11-26 17:38:29, Best in epoch 0, TOP 4: REC_T=0.22936, NDCG_T=0.15516
2023-11-26 17:38:29, Best in epoch 0, TOP 5: REC_V=0.26147, NDCG_V=0.16830
2023-11-26 17:38:29, Best in epoch 0, TOP 5: REC_T=0.29817, NDCG_T=0.18177
{'data_path': './datasets', 'batch_size_train': 128, 'batch_size_test': 128, 'topk': [1, 2, 3, 4, 5], 'neg_num': 1, 'aug_type': 'ED', 'ed_interval': 1, 'embedding_sizes': [64], 'num_layerss': [1], 'item_level_ratios': [0.2], 'bundle_level_ratios': [0.2], 'bundle_agg_ratios': [0.2], 'self_loop': False, 'lrs': [0.001], 'l2_regs': [0.0001], 'c_lambdas': [0.01], 'c_temps': [0.25], 'epochs': 30, 'UI_layers': [0.7, 0.3], 'seed': 2023, 'UB_coefs': [1, 1], 'UI_coefs': [1, 1], 'BI_coefs': [1, 1], 'sep': '\t', 'file_type': '.txt', 'topk_valid': 3, 'nhead': 3, 'extra_layer': True, 'dataset': 'food', 'model': 'CrossCBR', 'gpu': '0', 'info': '', 'num_users': 879, 'num_bundles': 1784, 'num_items': 3767, 'w1': 1.0, 'w2': 1.0, 'w3': 0.5, 'w4': 0.5, 'sw': 0.0, 'nw': 1.0, 'device': device(type='cpu'), 'l2_reg': 0.0001, 'embedding_size': 64, 'item_level_ratio': 0.2, 'bundle_level_ratio': 0.2, 'bundle_agg_ratio': 0.2, 'num_layers': 1, 'c_lambda': 0.01, 'c_temp': 0.25}
2023-11-27 12:45:00, Top_1, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:45:00, Top_1, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:45:00, Top_2, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:45:00, Top_2, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:45:00, Top_3, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:45:00, Top_3, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:45:00, Top_4, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:45:00, Top_4, Test: recall: 0.004587, ndcg: 0.001976
2023-11-27 12:45:00, Top_5, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:45:00, Top_5, Test: recall: 0.004587, ndcg: 0.001976
{'data_path': './datasets', 'batch_size_train': 128, 'batch_size_test': 128, 'topk': [1, 2, 3, 4, 5], 'neg_num': 1, 'aug_type': 'ED', 'ed_interval': 1, 'embedding_sizes': [64], 'num_layerss': [1], 'item_level_ratios': [0.2], 'bundle_level_ratios': [0.2], 'bundle_agg_ratios': [0.2], 'self_loop': False, 'lrs': [0.001], 'l2_regs': [0.0001], 'c_lambdas': [0.01], 'c_temps': [0.25], 'epochs': 30, 'UI_layers': [0.7, 0.3], 'seed': 2023, 'UB_coefs': [1, 1], 'UI_coefs': [1, 1], 'BI_coefs': [1, 1], 'sep': '\t', 'file_type': '.txt', 'topk_valid': 3, 'nhead': 3, 'extra_layer': True, 'dataset': 'food', 'model': 'CrossCBR', 'gpu': '0', 'info': '', 'num_users': 879, 'num_bundles': 1784, 'num_items': 3767, 'w1': 1.0, 'w2': 1.0, 'w3': 0.5, 'w4': 0.5, 'sw': 0.0, 'nw': 1.0, 'device': device(type='cpu'), 'l2_reg': 0.0001, 'embedding_size': 64, 'item_level_ratio': 0.2, 'bundle_level_ratio': 0.2, 'bundle_agg_ratio': 0.2, 'num_layers': 1, 'c_lambda': 0.01, 'c_temp': 0.25}
{'data_path': './datasets', 'batch_size_train': 128, 'batch_size_test': 128, 'topk': [1, 2, 3, 4, 5], 'neg_num': 1, 'aug_type': 'ED', 'ed_interval': 1, 'embedding_sizes': [64], 'num_layerss': [1], 'item_level_ratios': [0.2], 'bundle_level_ratios': [0.2], 'bundle_agg_ratios': [0.2], 'self_loop': False, 'lrs': [0.001], 'l2_regs': [0.0001], 'c_lambdas': [0.01], 'c_temps': [0.25], 'epochs': 30, 'UI_layers': [0.7, 0.3], 'seed': 2023, 'UB_coefs': [1, 1], 'UI_coefs': [1, 1], 'BI_coefs': [1, 1], 'sep': '\t', 'file_type': '.txt', 'topk_valid': 3, 'nhead': 3, 'extra_layer': True, 'dataset': 'food', 'model': 'CrossCBR', 'gpu': '0', 'info': '', 'num_users': 879, 'num_bundles': 1784, 'num_items': 3767, 'w1': 1.0, 'w2': 1.0, 'w3': 0.5, 'w4': 0.5, 'sw': 0.0, 'nw': 1.0, 'device': device(type='cpu'), 'l2_reg': 0.0001, 'embedding_size': 64, 'item_level_ratio': 0.2, 'bundle_level_ratio': 0.2, 'bundle_agg_ratio': 0.2, 'num_layers': 1, 'c_lambda': 0.01, 'c_temp': 0.25}
2023-11-27 12:46:33, Top_1, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:46:33, Top_1, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:46:33, Top_2, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:46:33, Top_2, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:46:33, Top_3, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:46:33, Top_3, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:46:33, Top_4, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:46:33, Top_4, Test: recall: 0.004587, ndcg: 0.001976
2023-11-27 12:46:33, Top_5, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:46:33, Top_5, Test: recall: 0.004587, ndcg: 0.001976
{'data_path': './datasets', 'batch_size_train': 128, 'batch_size_test': 128, 'topk': [1, 2, 3, 4, 5], 'neg_num': 1, 'aug_type': 'ED', 'ed_interval': 1, 'embedding_sizes': [64], 'num_layerss': [1], 'item_level_ratios': [0.2], 'bundle_level_ratios': [0.2], 'bundle_agg_ratios': [0.2], 'self_loop': False, 'lrs': [0.001], 'l2_regs': [0.0001], 'c_lambdas': [0.01], 'c_temps': [0.25], 'epochs': 30, 'UI_layers': [0.7, 0.3], 'seed': 2023, 'UB_coefs': [1, 1], 'UI_coefs': [1, 1], 'BI_coefs': [1, 1], 'sep': '\t', 'file_type': '.txt', 'topk_valid': 3, 'nhead': 3, 'extra_layer': True, 'dataset': 'food', 'model': 'CrossCBR', 'gpu': '0', 'info': '', 'num_users': 879, 'num_bundles': 1784, 'num_items': 3767, 'w1': 1.0, 'w2': 1.0, 'w3': 0.5, 'w4': 0.5, 'sw': 0.0, 'nw': 1.0, 'device': device(type='cpu'), 'l2_reg': 0.0001, 'embedding_size': 64, 'item_level_ratio': 0.2, 'bundle_level_ratio': 0.2, 'bundle_agg_ratio': 0.2, 'num_layers': 1, 'c_lambda': 0.01, 'c_temp': 0.25}
2023-11-27 12:48:06, Top_1, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:06, Top_1, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:06, Top_2, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:06, Top_2, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:06, Top_3, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:06, Top_3, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:06, Top_4, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:06, Top_4, Test: recall: 0.009174, ndcg: 0.003951
2023-11-27 12:48:06, Top_5, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:06, Top_5, Test: recall: 0.009174, ndcg: 0.003951
2023-11-27 12:48:07, Top_1, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:07, Top_1, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:08, Top_2, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:08, Top_2, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:08, Top_3, Val:  recall: 0.009174, ndcg: 0.004587
2023-11-27 12:48:08, Top_3, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:08, Top_4, Val:  recall: 0.013761, ndcg: 0.006563
2023-11-27 12:48:08, Top_4, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:08, Top_5, Val:  recall: 0.018349, ndcg: 0.008337
2023-11-27 12:48:08, Top_5, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:08, Best in epoch 1, TOP 1: REC_V=0.00000, NDCG_V=0.00000
2023-11-27 12:48:08, Best in epoch 1, TOP 1: REC_T=0.00000, NDCG_T=0.00000
2023-11-27 12:48:08, Best in epoch 1, TOP 2: REC_V=0.00000, NDCG_V=0.00000
2023-11-27 12:48:08, Best in epoch 1, TOP 2: REC_T=0.00000, NDCG_T=0.00000
2023-11-27 12:48:08, Best in epoch 1, TOP 3: REC_V=0.00917, NDCG_V=0.00459
2023-11-27 12:48:08, Best in epoch 1, TOP 3: REC_T=0.00000, NDCG_T=0.00000
2023-11-27 12:48:08, Best in epoch 1, TOP 4: REC_V=0.01376, NDCG_V=0.00656
2023-11-27 12:48:08, Best in epoch 1, TOP 4: REC_T=0.00000, NDCG_T=0.00000
2023-11-27 12:48:08, Best in epoch 1, TOP 5: REC_V=0.01835, NDCG_V=0.00834
2023-11-27 12:48:08, Best in epoch 1, TOP 5: REC_T=0.00000, NDCG_T=0.00000
2023-11-27 12:48:09, Top_1, Val:  recall: 0.004587, ndcg: 0.004587
2023-11-27 12:48:09, Top_1, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:09, Top_2, Val:  recall: 0.018349, ndcg: 0.013270
2023-11-27 12:48:09, Top_2, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:09, Top_3, Val:  recall: 0.018349, ndcg: 0.013270
2023-11-27 12:48:09, Top_3, Test: recall: 0.013761, ndcg: 0.006881
2023-11-27 12:48:09, Top_4, Val:  recall: 0.027523, ndcg: 0.017221
2023-11-27 12:48:09, Top_4, Test: recall: 0.050459, ndcg: 0.022685
2023-11-27 12:48:09, Top_5, Val:  recall: 0.041284, ndcg: 0.022544
2023-11-27 12:48:09, Top_5, Test: recall: 0.068807, ndcg: 0.029784
2023-11-27 12:48:09, Best in epoch 2, TOP 1: REC_V=0.00459, NDCG_V=0.00459
2023-11-27 12:48:09, Best in epoch 2, TOP 1: REC_T=0.00000, NDCG_T=0.00000
2023-11-27 12:48:09, Best in epoch 2, TOP 2: REC_V=0.01835, NDCG_V=0.01327
2023-11-27 12:48:09, Best in epoch 2, TOP 2: REC_T=0.00000, NDCG_T=0.00000
2023-11-27 12:48:09, Best in epoch 2, TOP 3: REC_V=0.01835, NDCG_V=0.01327
2023-11-27 12:48:09, Best in epoch 2, TOP 3: REC_T=0.01376, NDCG_T=0.00688
2023-11-27 12:48:09, Best in epoch 2, TOP 4: REC_V=0.02752, NDCG_V=0.01722
2023-11-27 12:48:09, Best in epoch 2, TOP 4: REC_T=0.05046, NDCG_T=0.02269
2023-11-27 12:48:09, Best in epoch 2, TOP 5: REC_V=0.04128, NDCG_V=0.02254
2023-11-27 12:48:09, Best in epoch 2, TOP 5: REC_T=0.06881, NDCG_T=0.02978
2023-11-27 12:48:11, Top_1, Val:  recall: 0.022936, ndcg: 0.022936
2023-11-27 12:48:11, Top_1, Test: recall: 0.022936, ndcg: 0.022936
2023-11-27 12:48:11, Top_2, Val:  recall: 0.082569, ndcg: 0.060560
2023-11-27 12:48:11, Top_2, Test: recall: 0.055046, ndcg: 0.043195
2023-11-27 12:48:11, Top_3, Val:  recall: 0.128440, ndcg: 0.083496
2023-11-27 12:48:11, Top_3, Test: recall: 0.096330, ndcg: 0.063837
2023-11-27 12:48:11, Top_4, Val:  recall: 0.174312, ndcg: 0.103252
2023-11-27 12:48:11, Top_4, Test: recall: 0.142202, ndcg: 0.083593
2023-11-27 12:48:11, Top_5, Val:  recall: 0.211009, ndcg: 0.117448
2023-11-27 12:48:11, Top_5, Test: recall: 0.178899, ndcg: 0.097789
2023-11-27 12:48:11, Best in epoch 3, TOP 1: REC_V=0.02294, NDCG_V=0.02294
2023-11-27 12:48:11, Best in epoch 3, TOP 1: REC_T=0.02294, NDCG_T=0.02294
2023-11-27 12:48:11, Best in epoch 3, TOP 2: REC_V=0.08257, NDCG_V=0.06056
2023-11-27 12:48:11, Best in epoch 3, TOP 2: REC_T=0.05505, NDCG_T=0.04319
2023-11-27 12:48:11, Best in epoch 3, TOP 3: REC_V=0.12844, NDCG_V=0.08350
2023-11-27 12:48:11, Best in epoch 3, TOP 3: REC_T=0.09633, NDCG_T=0.06384
2023-11-27 12:48:11, Best in epoch 3, TOP 4: REC_V=0.17431, NDCG_V=0.10325
2023-11-27 12:48:11, Best in epoch 3, TOP 4: REC_T=0.14220, NDCG_T=0.08359
2023-11-27 12:48:11, Best in epoch 3, TOP 5: REC_V=0.21101, NDCG_V=0.11745
2023-11-27 12:48:11, Best in epoch 3, TOP 5: REC_T=0.17890, NDCG_T=0.09779
2023-11-27 12:48:12, Top_1, Val:  recall: 0.091743, ndcg: 0.091743
2023-11-27 12:48:12, Top_1, Test: recall: 0.055046, ndcg: 0.055046
2023-11-27 12:48:12, Top_2, Val:  recall: 0.169725, ndcg: 0.140944
2023-11-27 12:48:12, Top_2, Test: recall: 0.137615, ndcg: 0.107141
2023-11-27 12:48:12, Top_3, Val:  recall: 0.229358, ndcg: 0.170761
2023-11-27 12:48:12, Top_3, Test: recall: 0.220183, ndcg: 0.148425
2023-11-27 12:48:12, Top_4, Val:  recall: 0.279817, ndcg: 0.192492
2023-11-27 12:48:12, Top_4, Test: recall: 0.284404, ndcg: 0.176084
2023-11-27 12:48:12, Top_5, Val:  recall: 0.334862, ndcg: 0.213787
2023-11-27 12:48:12, Top_5, Test: recall: 0.325688, ndcg: 0.192055
2023-11-27 12:48:12, Best in epoch 4, TOP 1: REC_V=0.09174, NDCG_V=0.09174
2023-11-27 12:48:12, Best in epoch 4, TOP 1: REC_T=0.05505, NDCG_T=0.05505
2023-11-27 12:48:12, Best in epoch 4, TOP 2: REC_V=0.16972, NDCG_V=0.14094
2023-11-27 12:48:12, Best in epoch 4, TOP 2: REC_T=0.13761, NDCG_T=0.10714
2023-11-27 12:48:12, Best in epoch 4, TOP 3: REC_V=0.22936, NDCG_V=0.17076
2023-11-27 12:48:12, Best in epoch 4, TOP 3: REC_T=0.22018, NDCG_T=0.14843
2023-11-27 12:48:12, Best in epoch 4, TOP 4: REC_V=0.27982, NDCG_V=0.19249
2023-11-27 12:48:12, Best in epoch 4, TOP 4: REC_T=0.28440, NDCG_T=0.17608
2023-11-27 12:48:12, Best in epoch 4, TOP 5: REC_V=0.33486, NDCG_V=0.21379
2023-11-27 12:48:12, Best in epoch 4, TOP 5: REC_T=0.32569, NDCG_T=0.19205
2023-11-27 12:48:14, Top_1, Val:  recall: 0.137615, ndcg: 0.137615
2023-11-27 12:48:14, Top_1, Test: recall: 0.110092, ndcg: 0.110092
2023-11-27 12:48:14, Top_2, Val:  recall: 0.243119, ndcg: 0.204181
2023-11-27 12:48:14, Top_2, Test: recall: 0.252294, ndcg: 0.199811
2023-11-27 12:48:14, Top_3, Val:  recall: 0.288991, ndcg: 0.227116
2023-11-27 12:48:14, Top_3, Test: recall: 0.325688, ndcg: 0.236508
2023-11-27 12:48:14, Top_4, Val:  recall: 0.362385, ndcg: 0.258726
2023-11-27 12:48:14, Top_4, Test: recall: 0.394495, ndcg: 0.266142
2023-11-27 12:48:14, Top_5, Val:  recall: 0.412844, ndcg: 0.278246
2023-11-27 12:48:14, Top_5, Test: recall: 0.481651, ndcg: 0.299859
2023-11-27 12:48:14, Best in epoch 5, TOP 1: REC_V=0.13761, NDCG_V=0.13761
2023-11-27 12:48:14, Best in epoch 5, TOP 1: REC_T=0.11009, NDCG_T=0.11009
2023-11-27 12:48:14, Best in epoch 5, TOP 2: REC_V=0.24312, NDCG_V=0.20418
2023-11-27 12:48:14, Best in epoch 5, TOP 2: REC_T=0.25229, NDCG_T=0.19981
2023-11-27 12:48:14, Best in epoch 5, TOP 3: REC_V=0.28899, NDCG_V=0.22712
2023-11-27 12:48:14, Best in epoch 5, TOP 3: REC_T=0.32569, NDCG_T=0.23651
2023-11-27 12:48:14, Best in epoch 5, TOP 4: REC_V=0.36239, NDCG_V=0.25873
2023-11-27 12:48:14, Best in epoch 5, TOP 4: REC_T=0.39450, NDCG_T=0.26614
2023-11-27 12:48:14, Best in epoch 5, TOP 5: REC_V=0.41284, NDCG_V=0.27825
2023-11-27 12:48:14, Best in epoch 5, TOP 5: REC_T=0.48165, NDCG_T=0.29986
2023-11-27 12:48:15, Top_1, Val:  recall: 0.192661, ndcg: 0.192661
2023-11-27 12:48:15, Top_1, Test: recall: 0.197248, ndcg: 0.197248
2023-11-27 12:48:15, Top_2, Val:  recall: 0.293578, ndcg: 0.256332
2023-11-27 12:48:15, Top_2, Test: recall: 0.348624, ndcg: 0.292755
2023-11-27 12:48:15, Top_3, Val:  recall: 0.366972, ndcg: 0.293030
2023-11-27 12:48:15, Top_3, Test: recall: 0.463303, ndcg: 0.350095
2023-11-27 12:48:15, Top_4, Val:  recall: 0.454128, ndcg: 0.330566
2023-11-27 12:48:15, Top_4, Test: recall: 0.536697, ndcg: 0.381704
2023-11-27 12:48:15, Top_5, Val:  recall: 0.518349, ndcg: 0.355409
2023-11-27 12:48:15, Top_5, Test: recall: 0.596330, ndcg: 0.404773
2023-11-27 12:48:15, Best in epoch 6, TOP 1: REC_V=0.19266, NDCG_V=0.19266
2023-11-27 12:48:15, Best in epoch 6, TOP 1: REC_T=0.19725, NDCG_T=0.19725
2023-11-27 12:48:15, Best in epoch 6, TOP 2: REC_V=0.29358, NDCG_V=0.25633
2023-11-27 12:48:15, Best in epoch 6, TOP 2: REC_T=0.34862, NDCG_T=0.29276
2023-11-27 12:48:15, Best in epoch 6, TOP 3: REC_V=0.36697, NDCG_V=0.29303
2023-11-27 12:48:15, Best in epoch 6, TOP 3: REC_T=0.46330, NDCG_T=0.35009
2023-11-27 12:48:15, Best in epoch 6, TOP 4: REC_V=0.45413, NDCG_V=0.33057
2023-11-27 12:48:15, Best in epoch 6, TOP 4: REC_T=0.53670, NDCG_T=0.38170
2023-11-27 12:48:15, Best in epoch 6, TOP 5: REC_V=0.51835, NDCG_V=0.35541
2023-11-27 12:48:15, Best in epoch 6, TOP 5: REC_T=0.59633, NDCG_T=0.40477
2023-11-27 12:48:17, Top_1, Val:  recall: 0.206422, ndcg: 0.206422
2023-11-27 12:48:17, Top_1, Test: recall: 0.206422, ndcg: 0.206422
2023-11-27 12:48:17, Top_2, Val:  recall: 0.334862, ndcg: 0.287459
2023-11-27 12:48:17, Top_2, Test: recall: 0.417431, ndcg: 0.339554
2023-11-27 12:48:17, Top_3, Val:  recall: 0.440367, ndcg: 0.340211
2023-11-27 12:48:17, Top_3, Test: recall: 0.518349, ndcg: 0.390013
2023-11-27 12:48:17, Top_4, Val:  recall: 0.536697, ndcg: 0.381698
2023-11-27 12:48:17, Top_4, Test: recall: 0.614679, ndcg: 0.431500
2023-11-27 12:48:17, Top_5, Val:  recall: 0.614679, ndcg: 0.411866
2023-11-27 12:48:17, Top_5, Test: recall: 0.683486, ndcg: 0.458118
2023-11-27 12:48:17, Best in epoch 7, TOP 1: REC_V=0.20642, NDCG_V=0.20642
2023-11-27 12:48:17, Best in epoch 7, TOP 1: REC_T=0.20642, NDCG_T=0.20642
2023-11-27 12:48:17, Best in epoch 7, TOP 2: REC_V=0.33486, NDCG_V=0.28746
2023-11-27 12:48:17, Best in epoch 7, TOP 2: REC_T=0.41743, NDCG_T=0.33955
2023-11-27 12:48:17, Best in epoch 7, TOP 3: REC_V=0.44037, NDCG_V=0.34021
2023-11-27 12:48:17, Best in epoch 7, TOP 3: REC_T=0.51835, NDCG_T=0.39001
2023-11-27 12:48:17, Best in epoch 7, TOP 4: REC_V=0.53670, NDCG_V=0.38170
2023-11-27 12:48:17, Best in epoch 7, TOP 4: REC_T=0.61468, NDCG_T=0.43150
2023-11-27 12:48:17, Best in epoch 7, TOP 5: REC_V=0.61468, NDCG_V=0.41187
2023-11-27 12:48:17, Best in epoch 7, TOP 5: REC_T=0.68349, NDCG_T=0.45812
2023-11-27 12:48:19, Top_1, Val:  recall: 0.220183, ndcg: 0.220183
2023-11-27 12:48:19, Top_1, Test: recall: 0.243119, ndcg: 0.243119
2023-11-27 12:48:19, Top_2, Val:  recall: 0.399083, ndcg: 0.333056
2023-11-27 12:48:19, Top_2, Test: recall: 0.458716, ndcg: 0.379145
2023-11-27 12:48:19, Top_3, Val:  recall: 0.513761, ndcg: 0.390396
2023-11-27 12:48:19, Top_3, Test: recall: 0.577982, ndcg: 0.438778
2023-11-27 12:48:19, Top_4, Val:  recall: 0.600917, ndcg: 0.427932
2023-11-27 12:48:19, Top_4, Test: recall: 0.669725, ndcg: 0.478290
2023-11-27 12:48:19, Top_5, Val:  recall: 0.651376, ndcg: 0.447452
2023-11-27 12:48:19, Top_5, Test: recall: 0.711009, ndcg: 0.494261
2023-11-27 12:48:19, Best in epoch 8, TOP 1: REC_V=0.22018, NDCG_V=0.22018
2023-11-27 12:48:19, Best in epoch 8, TOP 1: REC_T=0.24312, NDCG_T=0.24312
2023-11-27 12:48:19, Best in epoch 8, TOP 2: REC_V=0.39908, NDCG_V=0.33306
2023-11-27 12:48:19, Best in epoch 8, TOP 2: REC_T=0.45872, NDCG_T=0.37915
2023-11-27 12:48:19, Best in epoch 8, TOP 3: REC_V=0.51376, NDCG_V=0.39040
2023-11-27 12:48:19, Best in epoch 8, TOP 3: REC_T=0.57798, NDCG_T=0.43878
2023-11-27 12:48:19, Best in epoch 8, TOP 4: REC_V=0.60092, NDCG_V=0.42793
2023-11-27 12:48:19, Best in epoch 8, TOP 4: REC_T=0.66972, NDCG_T=0.47829
2023-11-27 12:48:19, Best in epoch 8, TOP 5: REC_V=0.65138, NDCG_V=0.44745
2023-11-27 12:48:19, Best in epoch 8, TOP 5: REC_T=0.71101, NDCG_T=0.49426
2023-11-27 12:48:20, Top_1, Val:  recall: 0.238532, ndcg: 0.238532
2023-11-27 12:48:20, Top_1, Test: recall: 0.266055, ndcg: 0.266055
2023-11-27 12:48:20, Top_2, Val:  recall: 0.454128, ndcg: 0.374558
2023-11-27 12:48:20, Top_2, Test: recall: 0.513761, ndcg: 0.422340
2023-11-27 12:48:20, Top_3, Val:  recall: 0.582569, ndcg: 0.438778
2023-11-27 12:48:20, Top_3, Test: recall: 0.637615, ndcg: 0.484267
2023-11-27 12:48:20, Top_4, Val:  recall: 0.642202, ndcg: 0.464461
2023-11-27 12:48:20, Top_4, Test: recall: 0.715596, ndcg: 0.517852
2023-11-27 12:48:20, Top_5, Val:  recall: 0.706422, ndcg: 0.489305
2023-11-27 12:48:20, Top_5, Test: recall: 0.756881, ndcg: 0.533823
2023-11-27 12:48:20, Best in epoch 9, TOP 1: REC_V=0.23853, NDCG_V=0.23853
2023-11-27 12:48:20, Best in epoch 9, TOP 1: REC_T=0.26606, NDCG_T=0.26606
2023-11-27 12:48:20, Best in epoch 9, TOP 2: REC_V=0.45413, NDCG_V=0.37456
2023-11-27 12:48:20, Best in epoch 9, TOP 2: REC_T=0.51376, NDCG_T=0.42234
2023-11-27 12:48:20, Best in epoch 9, TOP 3: REC_V=0.58257, NDCG_V=0.43878
2023-11-27 12:48:20, Best in epoch 9, TOP 3: REC_T=0.63761, NDCG_T=0.48427
2023-11-27 12:48:20, Best in epoch 9, TOP 4: REC_V=0.64220, NDCG_V=0.46446
2023-11-27 12:48:20, Best in epoch 9, TOP 4: REC_T=0.71560, NDCG_T=0.51785
2023-11-27 12:48:20, Best in epoch 9, TOP 5: REC_V=0.70642, NDCG_V=0.48930
2023-11-27 12:48:20, Best in epoch 9, TOP 5: REC_T=0.75688, NDCG_T=0.53382
2023-11-27 12:48:22, Top_1, Val:  recall: 0.270642, ndcg: 0.270642
2023-11-27 12:48:22, Top_1, Test: recall: 0.284404, ndcg: 0.284404
2023-11-27 12:48:22, Top_2, Val:  recall: 0.509174, ndcg: 0.421139
2023-11-27 12:48:22, Top_2, Test: recall: 0.522936, ndcg: 0.434901
2023-11-27 12:48:22, Top_3, Val:  recall: 0.591743, ndcg: 0.462424
2023-11-27 12:48:22, Top_3, Test: recall: 0.660550, ndcg: 0.503708
2023-11-27 12:48:22, Top_4, Val:  recall: 0.651376, ndcg: 0.488106
2023-11-27 12:48:22, Top_4, Test: recall: 0.733945, ndcg: 0.535317
2023-11-27 12:48:22, Top_5, Val:  recall: 0.720183, ndcg: 0.514724
2023-11-27 12:48:22, Top_5, Test: recall: 0.775229, ndcg: 0.551288
2023-11-27 12:48:22, Best in epoch 10, TOP 1: REC_V=0.27064, NDCG_V=0.27064
2023-11-27 12:48:22, Best in epoch 10, TOP 1: REC_T=0.28440, NDCG_T=0.28440
2023-11-27 12:48:22, Best in epoch 10, TOP 2: REC_V=0.50917, NDCG_V=0.42114
2023-11-27 12:48:22, Best in epoch 10, TOP 2: REC_T=0.52294, NDCG_T=0.43490
2023-11-27 12:48:22, Best in epoch 10, TOP 3: REC_V=0.59174, NDCG_V=0.46242
2023-11-27 12:48:22, Best in epoch 10, TOP 3: REC_T=0.66055, NDCG_T=0.50371
2023-11-27 12:48:22, Best in epoch 10, TOP 4: REC_V=0.65138, NDCG_V=0.48811
2023-11-27 12:48:22, Best in epoch 10, TOP 4: REC_T=0.73394, NDCG_T=0.53532
2023-11-27 12:48:22, Best in epoch 10, TOP 5: REC_V=0.72018, NDCG_V=0.51472
2023-11-27 12:48:22, Best in epoch 10, TOP 5: REC_T=0.77523, NDCG_T=0.55129
2023-11-27 12:48:23, Top_1, Val:  recall: 0.256881, ndcg: 0.256881
2023-11-27 12:48:23, Top_1, Test: recall: 0.321101, ndcg: 0.321101
2023-11-27 12:48:23, Top_2, Val:  recall: 0.518349, ndcg: 0.421849
2023-11-27 12:48:23, Top_2, Test: recall: 0.532110, ndcg: 0.454233
2023-11-27 12:48:23, Top_3, Val:  recall: 0.610092, ndcg: 0.467720
2023-11-27 12:48:23, Top_3, Test: recall: 0.669725, ndcg: 0.523040
2023-11-27 12:48:23, Top_4, Val:  recall: 0.678899, ndcg: 0.497354
2023-11-27 12:48:23, Top_4, Test: recall: 0.756881, ndcg: 0.560576
2023-11-27 12:48:23, Top_5, Val:  recall: 0.729358, ndcg: 0.516874
2023-11-27 12:48:23, Top_5, Test: recall: 0.793578, ndcg: 0.574773
2023-11-27 12:48:23, Best in epoch 11, TOP 1: REC_V=0.25688, NDCG_V=0.25688
2023-11-27 12:48:23, Best in epoch 11, TOP 1: REC_T=0.32110, NDCG_T=0.32110
2023-11-27 12:48:23, Best in epoch 11, TOP 2: REC_V=0.51835, NDCG_V=0.42185
2023-11-27 12:48:23, Best in epoch 11, TOP 2: REC_T=0.53211, NDCG_T=0.45423
2023-11-27 12:48:23, Best in epoch 11, TOP 3: REC_V=0.61009, NDCG_V=0.46772
2023-11-27 12:48:23, Best in epoch 11, TOP 3: REC_T=0.66972, NDCG_T=0.52304
2023-11-27 12:48:23, Best in epoch 11, TOP 4: REC_V=0.67890, NDCG_V=0.49735
2023-11-27 12:48:23, Best in epoch 11, TOP 4: REC_T=0.75688, NDCG_T=0.56058
2023-11-27 12:48:23, Best in epoch 11, TOP 5: REC_V=0.72936, NDCG_V=0.51687
2023-11-27 12:48:23, Best in epoch 11, TOP 5: REC_T=0.79358, NDCG_T=0.57477
{'data_path': './datasets', 'batch_size_train': 128, 'batch_size_test': 128, 'topk': [1, 2, 3, 4, 5], 'neg_num': 1, 'aug_type': 'ED', 'ed_interval': 1, 'embedding_sizes': [64], 'num_layerss': [1], 'item_level_ratios': [0.2], 'bundle_level_ratios': [0.2], 'bundle_agg_ratios': [0.2], 'self_loop': False, 'lrs': [0.001], 'l2_regs': [0.0001], 'c_lambdas': [0.01], 'c_temps': [0.25], 'epochs': 30, 'UI_layers': [0.7, 0.3], 'seed': 2023, 'UB_coefs': [1, 1], 'UI_coefs': [1, 1], 'BI_coefs': [1, 1], 'sep': '\t', 'file_type': '.txt', 'topk_valid': 3, 'nhead': 3, 'extra_layer': True, 'dataset': 'food', 'model': 'CrossCBR', 'gpu': '0', 'info': '', 'num_users': 879, 'num_bundles': 1784, 'num_items': 3767, 'w1': 1.0, 'w2': 1.0, 'w3': 0.5, 'w4': 0.5, 'sw': 0.0, 'nw': 1.0, 'device': device(type='cpu'), 'l2_reg': 0.0001, 'embedding_size': 64, 'item_level_ratio': 0.2, 'bundle_level_ratio': 0.2, 'bundle_agg_ratio': 0.2, 'num_layers': 1, 'c_lambda': 0.01, 'c_temp': 0.25}
2023-11-27 12:48:48, Top_1, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:48, Top_1, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:48, Top_2, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:48, Top_2, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:48, Top_3, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:48, Top_3, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:48, Top_4, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:48, Top_4, Test: recall: 0.004587, ndcg: 0.001976
2023-11-27 12:48:48, Top_5, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:48, Top_5, Test: recall: 0.004587, ndcg: 0.001976
2023-11-27 12:48:50, Top_1, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:50, Top_1, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:50, Top_2, Val:  recall: 0.004587, ndcg: 0.002894
2023-11-27 12:48:50, Top_2, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:50, Top_3, Val:  recall: 0.009174, ndcg: 0.005188
2023-11-27 12:48:50, Top_3, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:50, Top_4, Val:  recall: 0.009174, ndcg: 0.005188
2023-11-27 12:48:50, Top_4, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:50, Top_5, Val:  recall: 0.009174, ndcg: 0.005188
2023-11-27 12:48:50, Top_5, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:50, Best in epoch 1, TOP 1: REC_V=0.00000, NDCG_V=0.00000
2023-11-27 12:48:50, Best in epoch 1, TOP 1: REC_T=0.00000, NDCG_T=0.00000
2023-11-27 12:48:50, Best in epoch 1, TOP 2: REC_V=0.00459, NDCG_V=0.00289
2023-11-27 12:48:50, Best in epoch 1, TOP 2: REC_T=0.00000, NDCG_T=0.00000
2023-11-27 12:48:50, Best in epoch 1, TOP 3: REC_V=0.00917, NDCG_V=0.00519
2023-11-27 12:48:50, Best in epoch 1, TOP 3: REC_T=0.00000, NDCG_T=0.00000
2023-11-27 12:48:50, Best in epoch 1, TOP 4: REC_V=0.00917, NDCG_V=0.00519
2023-11-27 12:48:50, Best in epoch 1, TOP 4: REC_T=0.00000, NDCG_T=0.00000
2023-11-27 12:48:50, Best in epoch 1, TOP 5: REC_V=0.00917, NDCG_V=0.00519
2023-11-27 12:48:50, Best in epoch 1, TOP 5: REC_T=0.00000, NDCG_T=0.00000
2023-11-27 12:48:52, Top_1, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:52, Top_1, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:52, Top_2, Val:  recall: 0.018349, ndcg: 0.011577
2023-11-27 12:48:52, Top_2, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 12:48:52, Top_3, Val:  recall: 0.032110, ndcg: 0.018457
2023-11-27 12:48:52, Top_3, Test: recall: 0.013761, ndcg: 0.006881
2023-11-27 12:48:52, Top_4, Val:  recall: 0.041284, ndcg: 0.022409
2023-11-27 12:48:52, Top_4, Test: recall: 0.036697, ndcg: 0.016759
2023-11-27 12:48:52, Top_5, Val:  recall: 0.064220, ndcg: 0.031281
2023-11-27 12:48:52, Top_5, Test: recall: 0.059633, ndcg: 0.025631
2023-11-27 12:48:52, Best in epoch 2, TOP 1: REC_V=0.00000, NDCG_V=0.00000
2023-11-27 12:48:52, Best in epoch 2, TOP 1: REC_T=0.00000, NDCG_T=0.00000
2023-11-27 12:48:52, Best in epoch 2, TOP 2: REC_V=0.01835, NDCG_V=0.01158
2023-11-27 12:48:52, Best in epoch 2, TOP 2: REC_T=0.00000, NDCG_T=0.00000
2023-11-27 12:48:52, Best in epoch 2, TOP 3: REC_V=0.03211, NDCG_V=0.01846
2023-11-27 12:48:52, Best in epoch 2, TOP 3: REC_T=0.01376, NDCG_T=0.00688
2023-11-27 12:48:52, Best in epoch 2, TOP 4: REC_V=0.04128, NDCG_V=0.02241
2023-11-27 12:48:52, Best in epoch 2, TOP 4: REC_T=0.03670, NDCG_T=0.01676
2023-11-27 12:48:52, Best in epoch 2, TOP 5: REC_V=0.06422, NDCG_V=0.03128
2023-11-27 12:48:52, Best in epoch 2, TOP 5: REC_T=0.05963, NDCG_T=0.02563
{'data_path': './datasets', 'batch_size_train': 128, 'batch_size_test': 128, 'topk': [1, 2, 3, 4, 5], 'neg_num': 1, 'aug_type': 'ED', 'ed_interval': 1, 'embedding_sizes': [64], 'num_layerss': [1], 'item_level_ratios': [0.2], 'bundle_level_ratios': [0.2], 'bundle_agg_ratios': [0.2], 'self_loop': False, 'lrs': [0.001], 'l2_regs': [0.0001], 'c_lambdas': [0.01], 'c_temps': [0.25], 'epochs': 30, 'UI_layers': [0.7, 0.3], 'seed': 2023, 'UB_coefs': [1, 1], 'UI_coefs': [1, 1], 'BI_coefs': [1, 1], 'sep': '\t', 'file_type': '.txt', 'topk_valid': 3, 'nhead': 3, 'extra_layer': True, 'dataset': 'food', 'model': 'CrossCBR', 'gpu': '0', 'info': '', 'num_users': 879, 'num_bundles': 1784, 'num_items': 3767, 'w1': 1.0, 'w2': 1.0, 'w3': 0.1, 'w4': 0.1, 'sw': 0.9, 'nw': 0.8, 'device': device(type='cpu'), 'l2_reg': 0.0001, 'embedding_size': 64, 'item_level_ratio': 0.2, 'bundle_level_ratio': 0.2, 'bundle_agg_ratio': 0.2, 'num_layers': 1, 'c_lambda': 0.01, 'c_temp': 0.25}
2023-11-27 12:49:34, Top_1, Val:  recall: 0.091743, ndcg: 0.091743
2023-11-27 12:49:34, Top_1, Test: recall: 0.114679, ndcg: 0.114679
2023-11-27 12:49:34, Top_2, Val:  recall: 0.192661, ndcg: 0.155415
2023-11-27 12:49:34, Top_2, Test: recall: 0.160550, ndcg: 0.143621
2023-11-27 12:49:34, Top_3, Val:  recall: 0.233945, ndcg: 0.176057
2023-11-27 12:49:34, Top_3, Test: recall: 0.220183, ndcg: 0.173437
2023-11-27 12:49:34, Top_4, Val:  recall: 0.256881, ndcg: 0.185935
2023-11-27 12:49:34, Top_4, Test: recall: 0.266055, ndcg: 0.193193
2023-11-27 12:49:34, Top_5, Val:  recall: 0.307339, ndcg: 0.205455
2023-11-27 12:49:34, Top_5, Test: recall: 0.330275, ndcg: 0.218037
2023-11-27 12:49:34, Best in epoch 0, TOP 1: REC_V=0.09174, NDCG_V=0.09174
2023-11-27 12:49:34, Best in epoch 0, TOP 1: REC_T=0.11468, NDCG_T=0.11468
2023-11-27 12:49:34, Best in epoch 0, TOP 2: REC_V=0.19266, NDCG_V=0.15541
2023-11-27 12:49:34, Best in epoch 0, TOP 2: REC_T=0.16055, NDCG_T=0.14362
2023-11-27 12:49:34, Best in epoch 0, TOP 3: REC_V=0.23394, NDCG_V=0.17606
2023-11-27 12:49:34, Best in epoch 0, TOP 3: REC_T=0.22018, NDCG_T=0.17344
2023-11-27 12:49:34, Best in epoch 0, TOP 4: REC_V=0.25688, NDCG_V=0.18594
2023-11-27 12:49:34, Best in epoch 0, TOP 4: REC_T=0.26606, NDCG_T=0.19319
2023-11-27 12:49:34, Best in epoch 0, TOP 5: REC_V=0.30734, NDCG_V=0.20546
2023-11-27 12:49:34, Best in epoch 0, TOP 5: REC_T=0.33028, NDCG_T=0.21804
2023-11-27 12:49:36, Top_1, Val:  recall: 0.247706, ndcg: 0.247706
2023-11-27 12:49:36, Top_1, Test: recall: 0.243119, ndcg: 0.243119
2023-11-27 12:49:36, Top_2, Val:  recall: 0.435780, ndcg: 0.366368
2023-11-27 12:49:36, Top_2, Test: recall: 0.403670, ndcg: 0.344415
2023-11-27 12:49:36, Top_3, Val:  recall: 0.504587, ndcg: 0.400771
2023-11-27 12:49:36, Top_3, Test: recall: 0.500000, ndcg: 0.392580
2023-11-27 12:49:36, Top_4, Val:  recall: 0.564220, ndcg: 0.426454
2023-11-27 12:49:36, Top_4, Test: recall: 0.568807, ndcg: 0.422214
2023-11-27 12:49:36, Top_5, Val:  recall: 0.605505, ndcg: 0.442425
2023-11-27 12:49:36, Top_5, Test: recall: 0.633028, ndcg: 0.447058
2023-11-27 12:49:36, Best in epoch 1, TOP 1: REC_V=0.24771, NDCG_V=0.24771
2023-11-27 12:49:36, Best in epoch 1, TOP 1: REC_T=0.24312, NDCG_T=0.24312
2023-11-27 12:49:36, Best in epoch 1, TOP 2: REC_V=0.43578, NDCG_V=0.36637
2023-11-27 12:49:36, Best in epoch 1, TOP 2: REC_T=0.40367, NDCG_T=0.34442
2023-11-27 12:49:36, Best in epoch 1, TOP 3: REC_V=0.50459, NDCG_V=0.40077
2023-11-27 12:49:36, Best in epoch 1, TOP 3: REC_T=0.50000, NDCG_T=0.39258
2023-11-27 12:49:36, Best in epoch 1, TOP 4: REC_V=0.56422, NDCG_V=0.42645
2023-11-27 12:49:36, Best in epoch 1, TOP 4: REC_T=0.56881, NDCG_T=0.42221
2023-11-27 12:49:36, Best in epoch 1, TOP 5: REC_V=0.60550, NDCG_V=0.44242
2023-11-27 12:49:36, Best in epoch 1, TOP 5: REC_T=0.63303, NDCG_T=0.44706
{'data_path': './datasets', 'batch_size_train': 128, 'batch_size_test': 128, 'topk': [1, 2, 3, 4, 5], 'neg_num': 1, 'aug_type': 'ED', 'ed_interval': 1, 'embedding_sizes': [64], 'num_layerss': [1], 'item_level_ratios': [0.2], 'bundle_level_ratios': [0.2], 'bundle_agg_ratios': [0.2], 'self_loop': False, 'lrs': [0.001], 'l2_regs': [0.0001], 'c_lambdas': [0.01], 'c_temps': [0.25], 'epochs': 30, 'UI_layers': [0.7, 0.3], 'seed': 2023, 'UB_coefs': [1, 1], 'UI_coefs': [1, 1], 'BI_coefs': [1, 1], 'sep': '\t', 'file_type': '.txt', 'topk_valid': 3, 'nhead': 3, 'extra_layer': True, 'dataset': 'food', 'model': 'CrossCBR', 'gpu': '0', 'info': '', 'num_users': 879, 'num_bundles': 1784, 'num_items': 3767, 'w1': 1.0, 'w2': 1.0, 'w3': 0.1, 'w4': 0.1, 'sw': 0.9, 'nw': 0.8, 'device': device(type='cpu'), 'l2_reg': 0.0001, 'embedding_size': 64, 'item_level_ratio': 0.2, 'bundle_level_ratio': 0.2, 'bundle_agg_ratio': 0.2, 'num_layers': 1, 'c_lambda': 0.01, 'c_temp': 0.25}
2023-11-27 12:50:07, Top_1, Val:  recall: 0.091743, ndcg: 0.091743
2023-11-27 12:50:07, Top_1, Test: recall: 0.114679, ndcg: 0.114679
2023-11-27 12:50:07, Top_2, Val:  recall: 0.192661, ndcg: 0.155415
2023-11-27 12:50:07, Top_2, Test: recall: 0.160550, ndcg: 0.143621
2023-11-27 12:50:07, Top_3, Val:  recall: 0.233945, ndcg: 0.176057
2023-11-27 12:50:07, Top_3, Test: recall: 0.220183, ndcg: 0.173437
2023-11-27 12:50:07, Top_4, Val:  recall: 0.256881, ndcg: 0.185935
2023-11-27 12:50:07, Top_4, Test: recall: 0.266055, ndcg: 0.193193
2023-11-27 12:50:07, Top_5, Val:  recall: 0.307339, ndcg: 0.205455
2023-11-27 12:50:07, Top_5, Test: recall: 0.330275, ndcg: 0.218037
2023-11-27 12:50:07, Best in epoch 0, TOP 1: REC_V=0.09174, NDCG_V=0.09174
2023-11-27 12:50:07, Best in epoch 0, TOP 1: REC_T=0.11468, NDCG_T=0.11468
2023-11-27 12:50:07, Best in epoch 0, TOP 2: REC_V=0.19266, NDCG_V=0.15541
2023-11-27 12:50:07, Best in epoch 0, TOP 2: REC_T=0.16055, NDCG_T=0.14362
2023-11-27 12:50:07, Best in epoch 0, TOP 3: REC_V=0.23394, NDCG_V=0.17606
2023-11-27 12:50:07, Best in epoch 0, TOP 3: REC_T=0.22018, NDCG_T=0.17344
2023-11-27 12:50:07, Best in epoch 0, TOP 4: REC_V=0.25688, NDCG_V=0.18594
2023-11-27 12:50:07, Best in epoch 0, TOP 4: REC_T=0.26606, NDCG_T=0.19319
2023-11-27 12:50:07, Best in epoch 0, TOP 5: REC_V=0.30734, NDCG_V=0.20546
2023-11-27 12:50:07, Best in epoch 0, TOP 5: REC_T=0.33028, NDCG_T=0.21804
2023-11-27 12:50:09, Top_1, Val:  recall: 0.247706, ndcg: 0.247706
2023-11-27 12:50:09, Top_1, Test: recall: 0.243119, ndcg: 0.243119
2023-11-27 12:50:09, Top_2, Val:  recall: 0.435780, ndcg: 0.366368
2023-11-27 12:50:09, Top_2, Test: recall: 0.403670, ndcg: 0.344415
2023-11-27 12:50:09, Top_3, Val:  recall: 0.504587, ndcg: 0.400771
2023-11-27 12:50:09, Top_3, Test: recall: 0.500000, ndcg: 0.392580
2023-11-27 12:50:09, Top_4, Val:  recall: 0.564220, ndcg: 0.426454
2023-11-27 12:50:09, Top_4, Test: recall: 0.568807, ndcg: 0.422214
2023-11-27 12:50:09, Top_5, Val:  recall: 0.605505, ndcg: 0.442425
2023-11-27 12:50:09, Top_5, Test: recall: 0.633028, ndcg: 0.447058
2023-11-27 12:50:09, Best in epoch 1, TOP 1: REC_V=0.24771, NDCG_V=0.24771
2023-11-27 12:50:09, Best in epoch 1, TOP 1: REC_T=0.24312, NDCG_T=0.24312
2023-11-27 12:50:09, Best in epoch 1, TOP 2: REC_V=0.43578, NDCG_V=0.36637
2023-11-27 12:50:09, Best in epoch 1, TOP 2: REC_T=0.40367, NDCG_T=0.34442
2023-11-27 12:50:09, Best in epoch 1, TOP 3: REC_V=0.50459, NDCG_V=0.40077
2023-11-27 12:50:09, Best in epoch 1, TOP 3: REC_T=0.50000, NDCG_T=0.39258
2023-11-27 12:50:09, Best in epoch 1, TOP 4: REC_V=0.56422, NDCG_V=0.42645
2023-11-27 12:50:09, Best in epoch 1, TOP 4: REC_T=0.56881, NDCG_T=0.42221
2023-11-27 12:50:09, Best in epoch 1, TOP 5: REC_V=0.60550, NDCG_V=0.44242
2023-11-27 12:50:09, Best in epoch 1, TOP 5: REC_T=0.63303, NDCG_T=0.44706
2023-11-27 12:50:11, Top_1, Val:  recall: 0.325688, ndcg: 0.325688
2023-11-27 12:50:11, Top_1, Test: recall: 0.344037, ndcg: 0.344037
2023-11-27 12:50:11, Top_2, Val:  recall: 0.577982, ndcg: 0.484868
2023-11-27 12:50:11, Top_2, Test: recall: 0.600917, ndcg: 0.506110
2023-11-27 12:50:11, Top_3, Val:  recall: 0.678899, ndcg: 0.535326
2023-11-27 12:50:11, Top_3, Test: recall: 0.697248, ndcg: 0.554276
2023-11-27 12:50:11, Top_4, Val:  recall: 0.743119, ndcg: 0.562984
2023-11-27 12:50:11, Top_4, Test: recall: 0.752294, ndcg: 0.577982
2023-11-27 12:50:11, Top_5, Val:  recall: 0.807339, ndcg: 0.587828
2023-11-27 12:50:11, Top_5, Test: recall: 0.821101, ndcg: 0.604601
2023-11-27 12:50:11, Best in epoch 2, TOP 1: REC_V=0.32569, NDCG_V=0.32569
2023-11-27 12:50:11, Best in epoch 2, TOP 1: REC_T=0.34404, NDCG_T=0.34404
2023-11-27 12:50:11, Best in epoch 2, TOP 2: REC_V=0.57798, NDCG_V=0.48487
2023-11-27 12:50:11, Best in epoch 2, TOP 2: REC_T=0.60092, NDCG_T=0.50611
2023-11-27 12:50:11, Best in epoch 2, TOP 3: REC_V=0.67890, NDCG_V=0.53533
2023-11-27 12:50:11, Best in epoch 2, TOP 3: REC_T=0.69725, NDCG_T=0.55428
2023-11-27 12:50:11, Best in epoch 2, TOP 4: REC_V=0.74312, NDCG_V=0.56298
2023-11-27 12:50:11, Best in epoch 2, TOP 4: REC_T=0.75229, NDCG_T=0.57798
2023-11-27 12:50:11, Best in epoch 2, TOP 5: REC_V=0.80734, NDCG_V=0.58783
2023-11-27 12:50:11, Best in epoch 2, TOP 5: REC_T=0.82110, NDCG_T=0.60460
2023-11-27 12:50:12, Top_1, Val:  recall: 0.353211, ndcg: 0.353211
2023-11-27 12:50:12, Top_1, Test: recall: 0.412844, ndcg: 0.412844
2023-11-27 12:50:12, Top_2, Val:  recall: 0.688073, ndcg: 0.564486
2023-11-27 12:50:12, Top_2, Test: recall: 0.706422, ndcg: 0.598071
2023-11-27 12:50:12, Top_3, Val:  recall: 0.784404, ndcg: 0.612651
2023-11-27 12:50:12, Top_3, Test: recall: 0.788991, ndcg: 0.639356
2023-11-27 12:50:12, Top_4, Val:  recall: 0.844037, ndcg: 0.638333
2023-11-27 12:50:12, Top_4, Test: recall: 0.862385, ndcg: 0.670965
2023-11-27 12:50:12, Top_5, Val:  recall: 0.885321, ndcg: 0.654304
2023-11-27 12:50:12, Top_5, Test: recall: 0.912844, ndcg: 0.690485
2023-11-27 12:50:12, Best in epoch 3, TOP 1: REC_V=0.35321, NDCG_V=0.35321
2023-11-27 12:50:12, Best in epoch 3, TOP 1: REC_T=0.41284, NDCG_T=0.41284
2023-11-27 12:50:12, Best in epoch 3, TOP 2: REC_V=0.68807, NDCG_V=0.56449
2023-11-27 12:50:12, Best in epoch 3, TOP 2: REC_T=0.70642, NDCG_T=0.59807
2023-11-27 12:50:12, Best in epoch 3, TOP 3: REC_V=0.78440, NDCG_V=0.61265
2023-11-27 12:50:12, Best in epoch 3, TOP 3: REC_T=0.78899, NDCG_T=0.63936
2023-11-27 12:50:12, Best in epoch 3, TOP 4: REC_V=0.84404, NDCG_V=0.63833
2023-11-27 12:50:12, Best in epoch 3, TOP 4: REC_T=0.86239, NDCG_T=0.67096
2023-11-27 12:50:12, Best in epoch 3, TOP 5: REC_V=0.88532, NDCG_V=0.65430
2023-11-27 12:50:12, Best in epoch 3, TOP 5: REC_T=0.91284, NDCG_T=0.69048
{'data_path': './datasets', 'batch_size_train': 128, 'batch_size_test': 128, 'topk': [1, 2, 3, 4, 5], 'neg_num': 1, 'aug_type': 'ED', 'ed_interval': 1, 'embedding_sizes': [64], 'num_layerss': [1], 'item_level_ratios': [0.2], 'bundle_level_ratios': [0.2], 'bundle_agg_ratios': [0.2], 'self_loop': False, 'lrs': [0.001], 'l2_regs': [0.0001], 'c_lambdas': [0.01], 'c_temps': [0.25], 'epochs': 30, 'UI_layers': [0.7, 0.3], 'seed': 2023, 'UB_coefs': [1, 1], 'UI_coefs': [1, 1], 'BI_coefs': [1, 1], 'sep': '\t', 'file_type': '.txt', 'topk_valid': 3, 'nhead': 3, 'extra_layer': True, 'dataset': 'food', 'model': 'CrossCBR', 'gpu': '0', 'info': '', 'num_users': 879, 'num_bundles': 1784, 'num_items': 3767, 'w1': 1.0, 'w2': 1.0, 'w3': 0.1, 'w4': 0.1, 'sw': 0.9, 'nw': 0.8, 'device': device(type='cpu'), 'l2_reg': 0.0001, 'embedding_size': 64, 'item_level_ratio': 0.2, 'bundle_level_ratio': 0.2, 'bundle_agg_ratio': 0.2, 'num_layers': 1, 'c_lambda': 0.01, 'c_temp': 0.25}
2023-11-27 12:51:52, Top_1, Val:  recall: 0.091743, ndcg: 0.091743
2023-11-27 12:51:52, Top_1, Test: recall: 0.114679, ndcg: 0.114679
2023-11-27 12:51:52, Top_2, Val:  recall: 0.192661, ndcg: 0.155415
2023-11-27 12:51:52, Top_2, Test: recall: 0.160550, ndcg: 0.143621
2023-11-27 12:51:52, Top_3, Val:  recall: 0.233945, ndcg: 0.176057
2023-11-27 12:51:52, Top_3, Test: recall: 0.220183, ndcg: 0.173437
2023-11-27 12:51:52, Top_4, Val:  recall: 0.256881, ndcg: 0.185935
2023-11-27 12:51:52, Top_4, Test: recall: 0.266055, ndcg: 0.193193
2023-11-27 12:51:52, Top_5, Val:  recall: 0.307339, ndcg: 0.205455
2023-11-27 12:51:52, Top_5, Test: recall: 0.330275, ndcg: 0.218037
2023-11-27 12:51:52, Best in epoch 0, TOP 1: REC_V=0.09174, NDCG_V=0.09174
2023-11-27 12:51:52, Best in epoch 0, TOP 1: REC_T=0.11468, NDCG_T=0.11468
2023-11-27 12:51:52, Best in epoch 0, TOP 2: REC_V=0.19266, NDCG_V=0.15541
2023-11-27 12:51:52, Best in epoch 0, TOP 2: REC_T=0.16055, NDCG_T=0.14362
2023-11-27 12:51:52, Best in epoch 0, TOP 3: REC_V=0.23394, NDCG_V=0.17606
2023-11-27 12:51:52, Best in epoch 0, TOP 3: REC_T=0.22018, NDCG_T=0.17344
2023-11-27 12:51:52, Best in epoch 0, TOP 4: REC_V=0.25688, NDCG_V=0.18594
2023-11-27 12:51:52, Best in epoch 0, TOP 4: REC_T=0.26606, NDCG_T=0.19319
2023-11-27 12:51:52, Best in epoch 0, TOP 5: REC_V=0.30734, NDCG_V=0.20546
2023-11-27 12:51:52, Best in epoch 0, TOP 5: REC_T=0.33028, NDCG_T=0.21804
{'data_path': './datasets', 'batch_size_train': 128, 'batch_size_test': 128, 'topk': [1, 2, 3, 4, 5], 'neg_num': 1, 'aug_type': 'ED', 'ed_interval': 1, 'embedding_sizes': [64], 'num_layerss': [1], 'item_level_ratios': [0.2], 'bundle_level_ratios': [0.2], 'bundle_agg_ratios': [0.2], 'self_loop': False, 'lrs': [0.001], 'l2_regs': [0.0001], 'c_lambdas': [0.01], 'c_temps': [0.25], 'epochs': 30, 'UI_layers': [0.7, 0.3], 'seed': 2023, 'UB_coefs': [1, 1], 'UI_coefs': [1, 1], 'BI_coefs': [1, 1], 'sep': '\t', 'file_type': '.txt', 'topk_valid': 3, 'nhead': 3, 'extra_layer': True, 'dataset': 'food', 'model': 'CrossCBR', 'gpu': '0', 'info': '', 'num_users': 879, 'num_bundles': 1784, 'num_items': 3767, 'w1': 1.0, 'w2': 1.0, 'w3': 0.1, 'w4': 0.1, 'sw': 0.9, 'nw': 0.8, 'device': device(type='cpu'), 'l2_reg': 0.0001, 'embedding_size': 64, 'item_level_ratio': 0.2, 'bundle_level_ratio': 0.2, 'bundle_agg_ratio': 0.2, 'num_layers': 1, 'c_lambda': 0.01, 'c_temp': 0.25}
2023-11-27 12:53:10, Top_1, Val:  recall: 0.091743, ndcg: 0.091743
2023-11-27 12:53:10, Top_1, Test: recall: 0.114679, ndcg: 0.114679
2023-11-27 12:53:10, Top_2, Val:  recall: 0.192661, ndcg: 0.155415
2023-11-27 12:53:10, Top_2, Test: recall: 0.160550, ndcg: 0.143621
2023-11-27 12:53:10, Top_3, Val:  recall: 0.233945, ndcg: 0.176057
2023-11-27 12:53:10, Top_3, Test: recall: 0.220183, ndcg: 0.173437
2023-11-27 12:53:10, Top_4, Val:  recall: 0.256881, ndcg: 0.185935
2023-11-27 12:53:10, Top_4, Test: recall: 0.266055, ndcg: 0.193193
2023-11-27 12:53:10, Top_5, Val:  recall: 0.307339, ndcg: 0.205455
2023-11-27 12:53:10, Top_5, Test: recall: 0.330275, ndcg: 0.218037
2023-11-27 12:53:10, Best in epoch 0, TOP 1: REC_V=0.09174, NDCG_V=0.09174
2023-11-27 12:53:10, Best in epoch 0, TOP 1: REC_T=0.11468, NDCG_T=0.11468
2023-11-27 12:53:10, Best in epoch 0, TOP 2: REC_V=0.19266, NDCG_V=0.15541
2023-11-27 12:53:10, Best in epoch 0, TOP 2: REC_T=0.16055, NDCG_T=0.14362
2023-11-27 12:53:10, Best in epoch 0, TOP 3: REC_V=0.23394, NDCG_V=0.17606
2023-11-27 12:53:10, Best in epoch 0, TOP 3: REC_T=0.22018, NDCG_T=0.17344
2023-11-27 12:53:10, Best in epoch 0, TOP 4: REC_V=0.25688, NDCG_V=0.18594
2023-11-27 12:53:10, Best in epoch 0, TOP 4: REC_T=0.26606, NDCG_T=0.19319
2023-11-27 12:53:10, Best in epoch 0, TOP 5: REC_V=0.30734, NDCG_V=0.20546
2023-11-27 12:53:10, Best in epoch 0, TOP 5: REC_T=0.33028, NDCG_T=0.21804
{'data_path': './datasets', 'batch_size_train': 128, 'batch_size_test': 128, 'topk': [1, 2, 3, 4, 5], 'neg_num': 1, 'aug_type': 'ED', 'ed_interval': 1, 'embedding_sizes': [64], 'num_layerss': [1], 'item_level_ratios': [0.2], 'bundle_level_ratios': [0.2], 'bundle_agg_ratios': [0.2], 'self_loop': False, 'lrs': [0.001], 'l2_regs': [0.0001], 'c_lambdas': [0.01], 'c_temps': [0.25], 'epochs': 30, 'UI_layers': [0.7, 0.3], 'seed': 2023, 'UB_coefs': [1, 1], 'UI_coefs': [1, 1], 'BI_coefs': [1, 1], 'sep': '\t', 'file_type': '.txt', 'topk_valid': 3, 'nhead': 3, 'extra_layer': True, 'dataset': 'food', 'model': 'CrossCBR', 'gpu': '0', 'info': '', 'num_users': 879, 'num_bundles': 1784, 'num_items': 3767, 'w1': 1.0, 'w2': 1.0, 'w3': 0.1, 'w4': 0.1, 'sw': 0.9, 'nw': 0.8, 'device': device(type='cpu'), 'l2_reg': 0.0001, 'embedding_size': 64, 'item_level_ratio': 0.2, 'bundle_level_ratio': 0.2, 'bundle_agg_ratio': 0.2, 'num_layers': 1, 'c_lambda': 0.01, 'c_temp': 0.25}
2023-11-27 13:22:04, Top_1, Val:  recall: 0.091743, ndcg: 0.091743
2023-11-27 13:22:04, Top_1, Test: recall: 0.114679, ndcg: 0.114679
2023-11-27 13:22:04, Top_2, Val:  recall: 0.192661, ndcg: 0.155415
2023-11-27 13:22:04, Top_2, Test: recall: 0.160550, ndcg: 0.143621
2023-11-27 13:22:04, Top_3, Val:  recall: 0.233945, ndcg: 0.176057
2023-11-27 13:22:04, Top_3, Test: recall: 0.220183, ndcg: 0.173437
2023-11-27 13:22:04, Top_4, Val:  recall: 0.256881, ndcg: 0.185935
2023-11-27 13:22:04, Top_4, Test: recall: 0.266055, ndcg: 0.193193
2023-11-27 13:22:04, Top_5, Val:  recall: 0.307339, ndcg: 0.205455
2023-11-27 13:22:04, Top_5, Test: recall: 0.330275, ndcg: 0.218037
2023-11-27 13:22:04, Best in epoch 0, TOP 1: REC_V=0.09174, NDCG_V=0.09174
2023-11-27 13:22:04, Best in epoch 0, TOP 1: REC_T=0.11468, NDCG_T=0.11468
2023-11-27 13:22:04, Best in epoch 0, TOP 2: REC_V=0.19266, NDCG_V=0.15541
2023-11-27 13:22:04, Best in epoch 0, TOP 2: REC_T=0.16055, NDCG_T=0.14362
2023-11-27 13:22:04, Best in epoch 0, TOP 3: REC_V=0.23394, NDCG_V=0.17606
2023-11-27 13:22:04, Best in epoch 0, TOP 3: REC_T=0.22018, NDCG_T=0.17344
2023-11-27 13:22:04, Best in epoch 0, TOP 4: REC_V=0.25688, NDCG_V=0.18594
2023-11-27 13:22:04, Best in epoch 0, TOP 4: REC_T=0.26606, NDCG_T=0.19319
2023-11-27 13:22:04, Best in epoch 0, TOP 5: REC_V=0.30734, NDCG_V=0.20546
2023-11-27 13:22:04, Best in epoch 0, TOP 5: REC_T=0.33028, NDCG_T=0.21804
2023-11-27 13:22:05, Top_1, Val:  recall: 0.247706, ndcg: 0.247706
2023-11-27 13:22:05, Top_1, Test: recall: 0.243119, ndcg: 0.243119
2023-11-27 13:22:05, Top_2, Val:  recall: 0.435780, ndcg: 0.366368
2023-11-27 13:22:05, Top_2, Test: recall: 0.403670, ndcg: 0.344415
2023-11-27 13:22:05, Top_3, Val:  recall: 0.504587, ndcg: 0.400771
2023-11-27 13:22:05, Top_3, Test: recall: 0.500000, ndcg: 0.392580
2023-11-27 13:22:05, Top_4, Val:  recall: 0.564220, ndcg: 0.426454
2023-11-27 13:22:05, Top_4, Test: recall: 0.568807, ndcg: 0.422214
2023-11-27 13:22:05, Top_5, Val:  recall: 0.605505, ndcg: 0.442425
2023-11-27 13:22:05, Top_5, Test: recall: 0.633028, ndcg: 0.447058
2023-11-27 13:22:05, Best in epoch 1, TOP 1: REC_V=0.24771, NDCG_V=0.24771
2023-11-27 13:22:05, Best in epoch 1, TOP 1: REC_T=0.24312, NDCG_T=0.24312
2023-11-27 13:22:05, Best in epoch 1, TOP 2: REC_V=0.43578, NDCG_V=0.36637
2023-11-27 13:22:05, Best in epoch 1, TOP 2: REC_T=0.40367, NDCG_T=0.34442
2023-11-27 13:22:05, Best in epoch 1, TOP 3: REC_V=0.50459, NDCG_V=0.40077
2023-11-27 13:22:05, Best in epoch 1, TOP 3: REC_T=0.50000, NDCG_T=0.39258
2023-11-27 13:22:05, Best in epoch 1, TOP 4: REC_V=0.56422, NDCG_V=0.42645
2023-11-27 13:22:05, Best in epoch 1, TOP 4: REC_T=0.56881, NDCG_T=0.42221
2023-11-27 13:22:05, Best in epoch 1, TOP 5: REC_V=0.60550, NDCG_V=0.44242
2023-11-27 13:22:05, Best in epoch 1, TOP 5: REC_T=0.63303, NDCG_T=0.44706
2023-11-27 13:22:07, Top_1, Val:  recall: 0.325688, ndcg: 0.325688
2023-11-27 13:22:07, Top_1, Test: recall: 0.344037, ndcg: 0.344037
2023-11-27 13:22:07, Top_2, Val:  recall: 0.577982, ndcg: 0.484868
2023-11-27 13:22:07, Top_2, Test: recall: 0.600917, ndcg: 0.506110
2023-11-27 13:22:07, Top_3, Val:  recall: 0.678899, ndcg: 0.535326
2023-11-27 13:22:07, Top_3, Test: recall: 0.697248, ndcg: 0.554276
2023-11-27 13:22:07, Top_4, Val:  recall: 0.743119, ndcg: 0.562984
2023-11-27 13:22:07, Top_4, Test: recall: 0.752294, ndcg: 0.577982
2023-11-27 13:22:07, Top_5, Val:  recall: 0.807339, ndcg: 0.587828
2023-11-27 13:22:07, Top_5, Test: recall: 0.821101, ndcg: 0.604601
2023-11-27 13:22:07, Best in epoch 2, TOP 1: REC_V=0.32569, NDCG_V=0.32569
2023-11-27 13:22:07, Best in epoch 2, TOP 1: REC_T=0.34404, NDCG_T=0.34404
2023-11-27 13:22:07, Best in epoch 2, TOP 2: REC_V=0.57798, NDCG_V=0.48487
2023-11-27 13:22:07, Best in epoch 2, TOP 2: REC_T=0.60092, NDCG_T=0.50611
2023-11-27 13:22:07, Best in epoch 2, TOP 3: REC_V=0.67890, NDCG_V=0.53533
2023-11-27 13:22:07, Best in epoch 2, TOP 3: REC_T=0.69725, NDCG_T=0.55428
2023-11-27 13:22:07, Best in epoch 2, TOP 4: REC_V=0.74312, NDCG_V=0.56298
2023-11-27 13:22:07, Best in epoch 2, TOP 4: REC_T=0.75229, NDCG_T=0.57798
2023-11-27 13:22:07, Best in epoch 2, TOP 5: REC_V=0.80734, NDCG_V=0.58783
2023-11-27 13:22:07, Best in epoch 2, TOP 5: REC_T=0.82110, NDCG_T=0.60460
2023-11-27 13:22:09, Top_1, Val:  recall: 0.353211, ndcg: 0.353211
2023-11-27 13:22:09, Top_1, Test: recall: 0.412844, ndcg: 0.412844
2023-11-27 13:22:09, Top_2, Val:  recall: 0.688073, ndcg: 0.564486
2023-11-27 13:22:09, Top_2, Test: recall: 0.706422, ndcg: 0.598071
2023-11-27 13:22:09, Top_3, Val:  recall: 0.784404, ndcg: 0.612651
2023-11-27 13:22:09, Top_3, Test: recall: 0.788991, ndcg: 0.639356
2023-11-27 13:22:09, Top_4, Val:  recall: 0.844037, ndcg: 0.638333
2023-11-27 13:22:09, Top_4, Test: recall: 0.862385, ndcg: 0.670965
2023-11-27 13:22:09, Top_5, Val:  recall: 0.885321, ndcg: 0.654304
2023-11-27 13:22:09, Top_5, Test: recall: 0.912844, ndcg: 0.690485
2023-11-27 13:22:09, Best in epoch 3, TOP 1: REC_V=0.35321, NDCG_V=0.35321
2023-11-27 13:22:09, Best in epoch 3, TOP 1: REC_T=0.41284, NDCG_T=0.41284
2023-11-27 13:22:09, Best in epoch 3, TOP 2: REC_V=0.68807, NDCG_V=0.56449
2023-11-27 13:22:09, Best in epoch 3, TOP 2: REC_T=0.70642, NDCG_T=0.59807
2023-11-27 13:22:09, Best in epoch 3, TOP 3: REC_V=0.78440, NDCG_V=0.61265
2023-11-27 13:22:09, Best in epoch 3, TOP 3: REC_T=0.78899, NDCG_T=0.63936
2023-11-27 13:22:09, Best in epoch 3, TOP 4: REC_V=0.84404, NDCG_V=0.63833
2023-11-27 13:22:09, Best in epoch 3, TOP 4: REC_T=0.86239, NDCG_T=0.67096
2023-11-27 13:22:09, Best in epoch 3, TOP 5: REC_V=0.88532, NDCG_V=0.65430
2023-11-27 13:22:09, Best in epoch 3, TOP 5: REC_T=0.91284, NDCG_T=0.69048
2023-11-27 13:22:11, Top_1, Val:  recall: 0.376147, ndcg: 0.376147
2023-11-27 13:22:11, Top_1, Test: recall: 0.444954, ndcg: 0.444954
2023-11-27 13:22:11, Top_2, Val:  recall: 0.775229, ndcg: 0.627940
2023-11-27 13:22:11, Top_2, Test: recall: 0.756881, ndcg: 0.641758
2023-11-27 13:22:11, Top_3, Val:  recall: 0.830275, ndcg: 0.655463
2023-11-27 13:22:11, Top_3, Test: recall: 0.853211, ndcg: 0.689923
2023-11-27 13:22:11, Top_4, Val:  recall: 0.880734, ndcg: 0.677194
2023-11-27 13:22:11, Top_4, Test: recall: 0.903670, ndcg: 0.711654
2023-11-27 13:22:11, Top_5, Val:  recall: 0.903670, ndcg: 0.686067
2023-11-27 13:22:11, Top_5, Test: recall: 0.922018, ndcg: 0.718753
2023-11-27 13:22:11, Best in epoch 4, TOP 1: REC_V=0.37615, NDCG_V=0.37615
2023-11-27 13:22:11, Best in epoch 4, TOP 1: REC_T=0.44495, NDCG_T=0.44495
2023-11-27 13:22:11, Best in epoch 4, TOP 2: REC_V=0.77523, NDCG_V=0.62794
2023-11-27 13:22:11, Best in epoch 4, TOP 2: REC_T=0.75688, NDCG_T=0.64176
2023-11-27 13:22:11, Best in epoch 4, TOP 3: REC_V=0.83028, NDCG_V=0.65546
2023-11-27 13:22:11, Best in epoch 4, TOP 3: REC_T=0.85321, NDCG_T=0.68992
2023-11-27 13:22:11, Best in epoch 4, TOP 4: REC_V=0.88073, NDCG_V=0.67719
2023-11-27 13:22:11, Best in epoch 4, TOP 4: REC_T=0.90367, NDCG_T=0.71165
2023-11-27 13:22:11, Best in epoch 4, TOP 5: REC_V=0.90367, NDCG_V=0.68607
2023-11-27 13:22:11, Best in epoch 4, TOP 5: REC_T=0.92202, NDCG_T=0.71875
2023-11-27 13:22:12, Top_1, Val:  recall: 0.394495, ndcg: 0.394495
2023-11-27 13:22:12, Top_1, Test: recall: 0.477064, ndcg: 0.477064
2023-11-27 13:22:12, Top_2, Val:  recall: 0.802752, ndcg: 0.652077
2023-11-27 13:22:12, Top_2, Test: recall: 0.811927, ndcg: 0.688339
2023-11-27 13:22:12, Top_3, Val:  recall: 0.857798, ndcg: 0.679600
2023-11-27 13:22:12, Top_3, Test: recall: 0.876147, ndcg: 0.720449
2023-11-27 13:22:12, Top_4, Val:  recall: 0.894495, ndcg: 0.695404
2023-11-27 13:22:12, Top_4, Test: recall: 0.912844, ndcg: 0.736254
2023-11-27 13:22:12, Top_5, Val:  recall: 0.908257, ndcg: 0.700728
2023-11-27 13:22:12, Top_5, Test: recall: 0.926606, ndcg: 0.741577
2023-11-27 13:22:12, Best in epoch 5, TOP 1: REC_V=0.39450, NDCG_V=0.39450
2023-11-27 13:22:12, Best in epoch 5, TOP 1: REC_T=0.47706, NDCG_T=0.47706
2023-11-27 13:22:12, Best in epoch 5, TOP 2: REC_V=0.80275, NDCG_V=0.65208
2023-11-27 13:22:12, Best in epoch 5, TOP 2: REC_T=0.81193, NDCG_T=0.68834
2023-11-27 13:22:12, Best in epoch 5, TOP 3: REC_V=0.85780, NDCG_V=0.67960
2023-11-27 13:22:12, Best in epoch 5, TOP 3: REC_T=0.87615, NDCG_T=0.72045
2023-11-27 13:22:12, Best in epoch 5, TOP 4: REC_V=0.89450, NDCG_V=0.69540
2023-11-27 13:22:12, Best in epoch 5, TOP 4: REC_T=0.91284, NDCG_T=0.73625
2023-11-27 13:22:12, Best in epoch 5, TOP 5: REC_V=0.90826, NDCG_V=0.70073
2023-11-27 13:22:12, Best in epoch 5, TOP 5: REC_T=0.92661, NDCG_T=0.74158
2023-11-27 13:22:14, Top_1, Val:  recall: 0.412844, ndcg: 0.412844
2023-11-27 13:22:14, Top_1, Test: recall: 0.477064, ndcg: 0.477064
2023-11-27 13:22:14, Top_2, Val:  recall: 0.830275, ndcg: 0.676214
2023-11-27 13:22:14, Top_2, Test: recall: 0.816514, ndcg: 0.691233
2023-11-27 13:22:14, Top_3, Val:  recall: 0.853211, ndcg: 0.687682
2023-11-27 13:22:14, Top_3, Test: recall: 0.889908, ndcg: 0.727930
2023-11-27 13:22:14, Top_4, Val:  recall: 0.889908, ndcg: 0.703486
2023-11-27 13:22:14, Top_4, Test: recall: 0.917431, ndcg: 0.739784
2023-11-27 13:22:14, Top_5, Val:  recall: 0.917431, ndcg: 0.714134
2023-11-27 13:22:14, Top_5, Test: recall: 0.931193, ndcg: 0.745107
2023-11-27 13:22:16, Top_1, Val:  recall: 0.422018, ndcg: 0.422018
2023-11-27 13:22:16, Top_1, Test: recall: 0.477064, ndcg: 0.477064
2023-11-27 13:22:16, Top_2, Val:  recall: 0.825688, ndcg: 0.676706
2023-11-27 13:22:16, Top_2, Test: recall: 0.830275, ndcg: 0.699916
2023-11-27 13:22:16, Top_3, Val:  recall: 0.871560, ndcg: 0.699641
2023-11-27 13:22:16, Top_3, Test: recall: 0.903670, ndcg: 0.736613
2023-11-27 13:22:16, Top_4, Val:  recall: 0.899083, ndcg: 0.711495
2023-11-27 13:22:16, Top_4, Test: recall: 0.926606, ndcg: 0.746491
2023-11-27 13:22:16, Top_5, Val:  recall: 0.917431, ndcg: 0.718593
2023-11-27 13:22:16, Top_5, Test: recall: 0.931193, ndcg: 0.748265
2023-11-27 13:22:16, Best in epoch 7, TOP 1: REC_V=0.42202, NDCG_V=0.42202
2023-11-27 13:22:16, Best in epoch 7, TOP 1: REC_T=0.47706, NDCG_T=0.47706
2023-11-27 13:22:16, Best in epoch 7, TOP 2: REC_V=0.82569, NDCG_V=0.67671
2023-11-27 13:22:16, Best in epoch 7, TOP 2: REC_T=0.83028, NDCG_T=0.69992
2023-11-27 13:22:16, Best in epoch 7, TOP 3: REC_V=0.87156, NDCG_V=0.69964
2023-11-27 13:22:16, Best in epoch 7, TOP 3: REC_T=0.90367, NDCG_T=0.73661
2023-11-27 13:22:16, Best in epoch 7, TOP 4: REC_V=0.89908, NDCG_V=0.71149
2023-11-27 13:22:16, Best in epoch 7, TOP 4: REC_T=0.92661, NDCG_T=0.74649
2023-11-27 13:22:16, Best in epoch 7, TOP 5: REC_V=0.91743, NDCG_V=0.71859
2023-11-27 13:22:16, Best in epoch 7, TOP 5: REC_T=0.93119, NDCG_T=0.74827
2023-11-27 13:22:17, Top_1, Val:  recall: 0.412844, ndcg: 0.412844
2023-11-27 13:22:17, Top_1, Test: recall: 0.477064, ndcg: 0.477064
2023-11-27 13:22:17, Top_2, Val:  recall: 0.816514, ndcg: 0.667531
2023-11-27 13:22:17, Top_2, Test: recall: 0.839450, ndcg: 0.705704
2023-11-27 13:22:17, Top_3, Val:  recall: 0.876147, ndcg: 0.697348
2023-11-27 13:22:17, Top_3, Test: recall: 0.908257, ndcg: 0.740108
2023-11-27 13:22:17, Top_4, Val:  recall: 0.889908, ndcg: 0.703275
2023-11-27 13:22:17, Top_4, Test: recall: 0.931193, ndcg: 0.749986
2023-11-27 13:22:17, Top_5, Val:  recall: 0.912844, ndcg: 0.712147
2023-11-27 13:22:17, Top_5, Test: recall: 0.944954, ndcg: 0.755309
{'data_path': './datasets', 'batch_size_train': 128, 'batch_size_test': 128, 'topk': [1, 2, 3, 4, 5], 'neg_num': 1, 'aug_type': 'ED', 'ed_interval': 1, 'embedding_sizes': [64], 'num_layerss': [1], 'item_level_ratios': [0.2], 'bundle_level_ratios': [0.2], 'bundle_agg_ratios': [0.2], 'self_loop': False, 'lrs': [0.001], 'l2_regs': [0.0001], 'c_lambdas': [0.01], 'c_temps': [0.25], 'epochs': 30, 'UI_layers': [0.7, 0.3], 'seed': 2023, 'UB_coefs': [1, 1], 'UI_coefs': [1, 1], 'BI_coefs': [1, 1], 'sep': '\t', 'file_type': '.txt', 'topk_valid': 3, 'nhead': 3, 'extra_layer': True, 'dataset': 'food', 'model': 'CrossCBR', 'gpu': '0', 'info': '', 'num_users': 879, 'num_bundles': 1784, 'num_items': 3767, 'w1': 1.0, 'w2': 1.0, 'w3': 0.1, 'w4': 0.1, 'sw': 0.9, 'nw': 0.8, 'device': device(type='cpu'), 'l2_reg': 0.0001, 'embedding_size': 64, 'item_level_ratio': 0.2, 'bundle_level_ratio': 0.2, 'bundle_agg_ratio': 0.2, 'num_layers': 1, 'c_lambda': 0.01, 'c_temp': 0.25}
{'data_path': './datasets', 'batch_size_train': 128, 'batch_size_test': 128, 'topk': [1, 2, 3, 4, 5], 'neg_num': 1, 'aug_type': 'ED', 'ed_interval': 1, 'embedding_sizes': [64], 'num_layerss': [1], 'item_level_ratios': [0.2], 'bundle_level_ratios': [0.2], 'bundle_agg_ratios': [0.2], 'self_loop': False, 'lrs': [0.001], 'l2_regs': [0.0001], 'c_lambdas': [0.01], 'c_temps': [0.25], 'epochs': 30, 'UI_layers': [0.7, 0.3], 'seed': 2023, 'UB_coefs': [1, 1], 'UI_coefs': [1, 1], 'BI_coefs': [1, 1], 'sep': '\t', 'file_type': '.txt', 'topk_valid': 3, 'nhead': 3, 'extra_layer': True, 'dataset': 'food', 'model': 'CrossCBR', 'gpu': '0', 'info': '', 'num_users': 879, 'num_bundles': 1784, 'num_items': 3767, 'w1': 1.0, 'w2': 1.0, 'w3': 0.1, 'w4': 0.1, 'sw': 0.9, 'nw': 0.8, 'device': device(type='cpu'), 'l2_reg': 0.0001, 'embedding_size': 64, 'item_level_ratio': 0.2, 'bundle_level_ratio': 0.2, 'bundle_agg_ratio': 0.2, 'num_layers': 1, 'c_lambda': 0.01, 'c_temp': 0.25}
2023-11-27 13:23:29, Top_1, Val:  recall: 0.087156, ndcg: 0.087156
2023-11-27 13:23:29, Top_1, Test: recall: 0.114679, ndcg: 0.114679
2023-11-27 13:23:29, Top_2, Val:  recall: 0.192661, ndcg: 0.153722
2023-11-27 13:23:29, Top_2, Test: recall: 0.151376, ndcg: 0.137832
2023-11-27 13:23:29, Top_3, Val:  recall: 0.233945, ndcg: 0.174364
2023-11-27 13:23:29, Top_3, Test: recall: 0.215596, ndcg: 0.169942
2023-11-27 13:23:29, Top_4, Val:  recall: 0.252294, ndcg: 0.182266
2023-11-27 13:23:29, Top_4, Test: recall: 0.266055, ndcg: 0.191674
2023-11-27 13:23:29, Top_5, Val:  recall: 0.298165, ndcg: 0.200012
2023-11-27 13:23:29, Top_5, Test: recall: 0.325688, ndcg: 0.214743
2023-11-27 13:23:29, Best in epoch 0, TOP 1: REC_V=0.08716, NDCG_V=0.08716
2023-11-27 13:23:29, Best in epoch 0, TOP 1: REC_T=0.11468, NDCG_T=0.11468
2023-11-27 13:23:29, Best in epoch 0, TOP 2: REC_V=0.19266, NDCG_V=0.15372
2023-11-27 13:23:29, Best in epoch 0, TOP 2: REC_T=0.15138, NDCG_T=0.13783
2023-11-27 13:23:29, Best in epoch 0, TOP 3: REC_V=0.23394, NDCG_V=0.17436
2023-11-27 13:23:29, Best in epoch 0, TOP 3: REC_T=0.21560, NDCG_T=0.16994
2023-11-27 13:23:29, Best in epoch 0, TOP 4: REC_V=0.25229, NDCG_V=0.18227
2023-11-27 13:23:29, Best in epoch 0, TOP 4: REC_T=0.26606, NDCG_T=0.19167
2023-11-27 13:23:29, Best in epoch 0, TOP 5: REC_V=0.29817, NDCG_V=0.20001
2023-11-27 13:23:29, Best in epoch 0, TOP 5: REC_T=0.32569, NDCG_T=0.21474
2023-11-27 13:23:30, Top_1, Val:  recall: 0.243119, ndcg: 0.243119
2023-11-27 13:23:30, Top_1, Test: recall: 0.252294, ndcg: 0.252294
2023-11-27 13:23:30, Top_2, Val:  recall: 0.426606, ndcg: 0.358886
2023-11-27 13:23:30, Top_2, Test: recall: 0.412844, ndcg: 0.353590
2023-11-27 13:23:30, Top_3, Val:  recall: 0.481651, ndcg: 0.386409
2023-11-27 13:23:30, Top_3, Test: recall: 0.495413, ndcg: 0.394874
2023-11-27 13:23:30, Top_4, Val:  recall: 0.568807, ndcg: 0.423945
2023-11-27 13:23:30, Top_4, Test: recall: 0.573394, ndcg: 0.428459
2023-11-27 13:23:30, Top_5, Val:  recall: 0.610092, ndcg: 0.439916
2023-11-27 13:23:30, Top_5, Test: recall: 0.633028, ndcg: 0.451528
2023-11-27 13:23:30, Best in epoch 1, TOP 1: REC_V=0.24312, NDCG_V=0.24312
2023-11-27 13:23:30, Best in epoch 1, TOP 1: REC_T=0.25229, NDCG_T=0.25229
2023-11-27 13:23:30, Best in epoch 1, TOP 2: REC_V=0.42661, NDCG_V=0.35889
2023-11-27 13:23:30, Best in epoch 1, TOP 2: REC_T=0.41284, NDCG_T=0.35359
2023-11-27 13:23:30, Best in epoch 1, TOP 3: REC_V=0.48165, NDCG_V=0.38641
2023-11-27 13:23:30, Best in epoch 1, TOP 3: REC_T=0.49541, NDCG_T=0.39487
2023-11-27 13:23:30, Best in epoch 1, TOP 4: REC_V=0.56881, NDCG_V=0.42395
2023-11-27 13:23:30, Best in epoch 1, TOP 4: REC_T=0.57339, NDCG_T=0.42846
2023-11-27 13:23:30, Best in epoch 1, TOP 5: REC_V=0.61009, NDCG_V=0.43992
2023-11-27 13:23:30, Best in epoch 1, TOP 5: REC_T=0.63303, NDCG_T=0.45153
2023-11-27 13:23:32, Top_1, Val:  recall: 0.321101, ndcg: 0.321101
2023-11-27 13:23:32, Top_1, Test: recall: 0.344037, ndcg: 0.344037
2023-11-27 13:23:32, Top_2, Val:  recall: 0.555046, ndcg: 0.468704
2023-11-27 13:23:32, Top_2, Test: recall: 0.587156, ndcg: 0.497428
2023-11-27 13:23:32, Top_3, Val:  recall: 0.678899, ndcg: 0.530630
2023-11-27 13:23:32, Top_3, Test: recall: 0.692661, ndcg: 0.550180
2023-11-27 13:23:32, Top_4, Val:  recall: 0.756881, ndcg: 0.564215
2023-11-27 13:23:32, Top_4, Test: recall: 0.747706, ndcg: 0.573887
2023-11-27 13:23:32, Top_5, Val:  recall: 0.798165, ndcg: 0.580186
2023-11-27 13:23:32, Top_5, Test: recall: 0.807339, ndcg: 0.596956
2023-11-27 13:23:32, Best in epoch 2, TOP 1: REC_V=0.32110, NDCG_V=0.32110
2023-11-27 13:23:32, Best in epoch 2, TOP 1: REC_T=0.34404, NDCG_T=0.34404
2023-11-27 13:23:32, Best in epoch 2, TOP 2: REC_V=0.55505, NDCG_V=0.46870
2023-11-27 13:23:32, Best in epoch 2, TOP 2: REC_T=0.58716, NDCG_T=0.49743
2023-11-27 13:23:32, Best in epoch 2, TOP 3: REC_V=0.67890, NDCG_V=0.53063
2023-11-27 13:23:32, Best in epoch 2, TOP 3: REC_T=0.69266, NDCG_T=0.55018
2023-11-27 13:23:32, Best in epoch 2, TOP 4: REC_V=0.75688, NDCG_V=0.56422
2023-11-27 13:23:32, Best in epoch 2, TOP 4: REC_T=0.74771, NDCG_T=0.57389
2023-11-27 13:23:32, Best in epoch 2, TOP 5: REC_V=0.79817, NDCG_V=0.58019
2023-11-27 13:23:32, Best in epoch 2, TOP 5: REC_T=0.80734, NDCG_T=0.59696
2023-11-27 13:23:34, Top_1, Val:  recall: 0.357798, ndcg: 0.357798
2023-11-27 13:23:34, Top_1, Test: recall: 0.412844, ndcg: 0.412844
2023-11-27 13:23:34, Top_2, Val:  recall: 0.697248, ndcg: 0.571967
2023-11-27 13:23:34, Top_2, Test: recall: 0.697248, ndcg: 0.592283
2023-11-27 13:23:34, Top_3, Val:  recall: 0.788991, ndcg: 0.617839
2023-11-27 13:23:34, Top_3, Test: recall: 0.793578, ndcg: 0.640448
2023-11-27 13:23:34, Top_4, Val:  recall: 0.839450, ndcg: 0.639570
2023-11-27 13:23:34, Top_4, Test: recall: 0.871560, ndcg: 0.674033
2023-11-27 13:23:34, Top_5, Val:  recall: 0.880734, ndcg: 0.655541
2023-11-27 13:23:34, Top_5, Test: recall: 0.912844, ndcg: 0.690004
2023-11-27 13:23:34, Best in epoch 3, TOP 1: REC_V=0.35780, NDCG_V=0.35780
2023-11-27 13:23:34, Best in epoch 3, TOP 1: REC_T=0.41284, NDCG_T=0.41284
2023-11-27 13:23:34, Best in epoch 3, TOP 2: REC_V=0.69725, NDCG_V=0.57197
2023-11-27 13:23:34, Best in epoch 3, TOP 2: REC_T=0.69725, NDCG_T=0.59228
2023-11-27 13:23:34, Best in epoch 3, TOP 3: REC_V=0.78899, NDCG_V=0.61784
2023-11-27 13:23:34, Best in epoch 3, TOP 3: REC_T=0.79358, NDCG_T=0.64045
2023-11-27 13:23:34, Best in epoch 3, TOP 4: REC_V=0.83945, NDCG_V=0.63957
2023-11-27 13:23:34, Best in epoch 3, TOP 4: REC_T=0.87156, NDCG_T=0.67403
2023-11-27 13:23:34, Best in epoch 3, TOP 5: REC_V=0.88073, NDCG_V=0.65554
2023-11-27 13:23:34, Best in epoch 3, TOP 5: REC_T=0.91284, NDCG_T=0.69000
2023-11-27 13:23:36, Top_1, Val:  recall: 0.385321, ndcg: 0.385321
2023-11-27 13:23:36, Top_1, Test: recall: 0.440367, ndcg: 0.440367
2023-11-27 13:23:36, Top_2, Val:  recall: 0.770642, ndcg: 0.628432
2023-11-27 13:23:36, Top_2, Test: recall: 0.761468, ndcg: 0.642959
2023-11-27 13:23:36, Top_3, Val:  recall: 0.844037, ndcg: 0.665129
2023-11-27 13:23:36, Top_3, Test: recall: 0.853211, ndcg: 0.688831
2023-11-27 13:23:36, Top_4, Val:  recall: 0.880734, ndcg: 0.680934
2023-11-27 13:23:36, Top_4, Test: recall: 0.899083, ndcg: 0.708586
2023-11-27 13:23:36, Top_5, Val:  recall: 0.903670, ndcg: 0.689806
2023-11-27 13:23:36, Top_5, Test: recall: 0.922018, ndcg: 0.717459
2023-11-27 13:23:36, Best in epoch 4, TOP 1: REC_V=0.38532, NDCG_V=0.38532
2023-11-27 13:23:36, Best in epoch 4, TOP 1: REC_T=0.44037, NDCG_T=0.44037
2023-11-27 13:23:36, Best in epoch 4, TOP 2: REC_V=0.77064, NDCG_V=0.62843
2023-11-27 13:23:36, Best in epoch 4, TOP 2: REC_T=0.76147, NDCG_T=0.64296
2023-11-27 13:23:36, Best in epoch 4, TOP 3: REC_V=0.84404, NDCG_V=0.66513
2023-11-27 13:23:36, Best in epoch 4, TOP 3: REC_T=0.85321, NDCG_T=0.68883
2023-11-27 13:23:36, Best in epoch 4, TOP 4: REC_V=0.88073, NDCG_V=0.68093
2023-11-27 13:23:36, Best in epoch 4, TOP 4: REC_T=0.89908, NDCG_T=0.70859
2023-11-27 13:23:36, Best in epoch 4, TOP 5: REC_V=0.90367, NDCG_V=0.68981
2023-11-27 13:23:36, Best in epoch 4, TOP 5: REC_T=0.92202, NDCG_T=0.71746
2023-11-27 13:23:38, Top_1, Val:  recall: 0.389908, ndcg: 0.389908
2023-11-27 13:23:38, Top_1, Test: recall: 0.472477, ndcg: 0.472477
2023-11-27 13:23:38, Top_2, Val:  recall: 0.802752, ndcg: 0.650384
2023-11-27 13:23:38, Top_2, Test: recall: 0.802752, ndcg: 0.680858
2023-11-27 13:23:38, Top_3, Val:  recall: 0.866972, ndcg: 0.682494
2023-11-27 13:23:38, Top_3, Test: recall: 0.885321, ndcg: 0.722142
2023-11-27 13:23:38, Top_4, Val:  recall: 0.899083, ndcg: 0.696323
2023-11-27 13:23:38, Top_4, Test: recall: 0.903670, ndcg: 0.730044
2023-11-27 13:23:38, Top_5, Val:  recall: 0.912844, ndcg: 0.701647
2023-11-27 13:23:38, Top_5, Test: recall: 0.917431, ndcg: 0.735368
2023-11-27 13:23:38, Best in epoch 5, TOP 1: REC_V=0.38991, NDCG_V=0.38991
2023-11-27 13:23:38, Best in epoch 5, TOP 1: REC_T=0.47248, NDCG_T=0.47248
2023-11-27 13:23:38, Best in epoch 5, TOP 2: REC_V=0.80275, NDCG_V=0.65038
2023-11-27 13:23:38, Best in epoch 5, TOP 2: REC_T=0.80275, NDCG_T=0.68086
2023-11-27 13:23:38, Best in epoch 5, TOP 3: REC_V=0.86697, NDCG_V=0.68249
2023-11-27 13:23:38, Best in epoch 5, TOP 3: REC_T=0.88532, NDCG_T=0.72214
2023-11-27 13:23:38, Best in epoch 5, TOP 4: REC_V=0.89908, NDCG_V=0.69632
2023-11-27 13:23:38, Best in epoch 5, TOP 4: REC_T=0.90367, NDCG_T=0.73004
2023-11-27 13:23:38, Best in epoch 5, TOP 5: REC_V=0.91284, NDCG_V=0.70165
2023-11-27 13:23:38, Best in epoch 5, TOP 5: REC_T=0.91743, NDCG_T=0.73537
2023-11-27 13:23:39, Top_1, Val:  recall: 0.399083, ndcg: 0.399083
2023-11-27 13:23:39, Top_1, Test: recall: 0.481651, ndcg: 0.481651
2023-11-27 13:23:39, Top_2, Val:  recall: 0.825688, ndcg: 0.668241
2023-11-27 13:23:39, Top_2, Test: recall: 0.816514, ndcg: 0.692926
2023-11-27 13:23:39, Top_3, Val:  recall: 0.871560, ndcg: 0.691176
2023-11-27 13:23:39, Top_3, Test: recall: 0.889908, ndcg: 0.729623
2023-11-27 13:23:39, Top_4, Val:  recall: 0.903670, ndcg: 0.705006
2023-11-27 13:23:39, Top_4, Test: recall: 0.922018, ndcg: 0.743452
2023-11-27 13:23:39, Top_5, Val:  recall: 0.922018, ndcg: 0.712104
2023-11-27 13:23:39, Top_5, Test: recall: 0.935780, ndcg: 0.748776
2023-11-27 13:23:39, Best in epoch 6, TOP 1: REC_V=0.39908, NDCG_V=0.39908
2023-11-27 13:23:39, Best in epoch 6, TOP 1: REC_T=0.48165, NDCG_T=0.48165
2023-11-27 13:23:39, Best in epoch 6, TOP 2: REC_V=0.82569, NDCG_V=0.66824
2023-11-27 13:23:39, Best in epoch 6, TOP 2: REC_T=0.81651, NDCG_T=0.69293
2023-11-27 13:23:39, Best in epoch 6, TOP 3: REC_V=0.87156, NDCG_V=0.69118
2023-11-27 13:23:39, Best in epoch 6, TOP 3: REC_T=0.88991, NDCG_T=0.72962
2023-11-27 13:23:39, Best in epoch 6, TOP 4: REC_V=0.90367, NDCG_V=0.70501
2023-11-27 13:23:39, Best in epoch 6, TOP 4: REC_T=0.92202, NDCG_T=0.74345
2023-11-27 13:23:39, Best in epoch 6, TOP 5: REC_V=0.92202, NDCG_V=0.71210
2023-11-27 13:23:39, Best in epoch 6, TOP 5: REC_T=0.93578, NDCG_T=0.74878
2023-11-27 13:23:41, Top_1, Val:  recall: 0.422018, ndcg: 0.422018
2023-11-27 13:23:41, Top_1, Test: recall: 0.481651, ndcg: 0.481651
2023-11-27 13:23:41, Top_2, Val:  recall: 0.825688, ndcg: 0.676706
2023-11-27 13:23:41, Top_2, Test: recall: 0.816514, ndcg: 0.692926
2023-11-27 13:23:41, Top_3, Val:  recall: 0.880734, ndcg: 0.704229
2023-11-27 13:23:41, Top_3, Test: recall: 0.912844, ndcg: 0.741091
2023-11-27 13:23:41, Top_4, Val:  recall: 0.894495, ndcg: 0.710155
2023-11-27 13:23:41, Top_4, Test: recall: 0.931193, ndcg: 0.748993
2023-11-27 13:23:41, Top_5, Val:  recall: 0.922018, ndcg: 0.720803
2023-11-27 13:23:41, Top_5, Test: recall: 0.940367, ndcg: 0.752543
2023-11-27 13:23:41, Best in epoch 7, TOP 1: REC_V=0.42202, NDCG_V=0.42202
2023-11-27 13:23:41, Best in epoch 7, TOP 1: REC_T=0.48165, NDCG_T=0.48165
2023-11-27 13:23:41, Best in epoch 7, TOP 2: REC_V=0.82569, NDCG_V=0.67671
2023-11-27 13:23:41, Best in epoch 7, TOP 2: REC_T=0.81651, NDCG_T=0.69293
2023-11-27 13:23:41, Best in epoch 7, TOP 3: REC_V=0.88073, NDCG_V=0.70423
2023-11-27 13:23:41, Best in epoch 7, TOP 3: REC_T=0.91284, NDCG_T=0.74109
2023-11-27 13:23:41, Best in epoch 7, TOP 4: REC_V=0.89450, NDCG_V=0.71016
2023-11-27 13:23:41, Best in epoch 7, TOP 4: REC_T=0.93119, NDCG_T=0.74899
2023-11-27 13:23:41, Best in epoch 7, TOP 5: REC_V=0.92202, NDCG_V=0.72080
2023-11-27 13:23:41, Best in epoch 7, TOP 5: REC_T=0.94037, NDCG_T=0.75254
2023-11-27 13:23:43, Top_1, Val:  recall: 0.412844, ndcg: 0.412844
2023-11-27 13:23:43, Top_1, Test: recall: 0.486239, ndcg: 0.486239
2023-11-27 13:23:43, Top_2, Val:  recall: 0.821101, ndcg: 0.670425
2023-11-27 13:23:43, Top_2, Test: recall: 0.844037, ndcg: 0.711984
2023-11-27 13:23:43, Top_3, Val:  recall: 0.880734, ndcg: 0.700242
2023-11-27 13:23:43, Top_3, Test: recall: 0.903670, ndcg: 0.741801
2023-11-27 13:23:43, Top_4, Val:  recall: 0.899083, ndcg: 0.708144
2023-11-27 13:23:43, Top_4, Test: recall: 0.922018, ndcg: 0.749703
2023-11-27 13:23:43, Top_5, Val:  recall: 0.917431, ndcg: 0.715243
2023-11-27 13:23:43, Top_5, Test: recall: 0.940367, ndcg: 0.756801
2023-11-27 13:23:45, Top_1, Val:  recall: 0.394495, ndcg: 0.394495
2023-11-27 13:23:45, Top_1, Test: recall: 0.500000, ndcg: 0.500000
2023-11-27 13:23:45, Top_2, Val:  recall: 0.825688, ndcg: 0.666548
2023-11-27 13:23:45, Top_2, Test: recall: 0.830275, ndcg: 0.708380
2023-11-27 13:23:45, Top_3, Val:  recall: 0.880734, ndcg: 0.694071
2023-11-27 13:23:45, Top_3, Test: recall: 0.899083, ndcg: 0.742784
2023-11-27 13:23:45, Top_4, Val:  recall: 0.899083, ndcg: 0.701973
2023-11-27 13:23:45, Top_4, Test: recall: 0.926606, ndcg: 0.754638
2023-11-27 13:23:45, Top_5, Val:  recall: 0.922018, ndcg: 0.710846
2023-11-27 13:23:45, Top_5, Test: recall: 0.949541, ndcg: 0.763510
2023-11-27 13:23:47, Top_1, Val:  recall: 0.394495, ndcg: 0.394495
2023-11-27 13:23:47, Top_1, Test: recall: 0.495413, ndcg: 0.495413
2023-11-27 13:23:47, Top_2, Val:  recall: 0.821101, ndcg: 0.663654
2023-11-27 13:23:47, Top_2, Test: recall: 0.830275, ndcg: 0.706687
2023-11-27 13:23:47, Top_3, Val:  recall: 0.880734, ndcg: 0.693470
2023-11-27 13:23:47, Top_3, Test: recall: 0.894495, ndcg: 0.738798
2023-11-27 13:23:47, Top_4, Val:  recall: 0.899083, ndcg: 0.701372
2023-11-27 13:23:47, Top_4, Test: recall: 0.931193, ndcg: 0.754602
2023-11-27 13:23:47, Top_5, Val:  recall: 0.926606, ndcg: 0.712020
2023-11-27 13:23:47, Top_5, Test: recall: 0.940367, ndcg: 0.758151
2023-11-27 13:23:48, Top_1, Val:  recall: 0.394495, ndcg: 0.394495
2023-11-27 13:23:48, Top_1, Test: recall: 0.486239, ndcg: 0.486239
2023-11-27 13:23:48, Top_2, Val:  recall: 0.802752, ndcg: 0.652077
2023-11-27 13:23:48, Top_2, Test: recall: 0.834862, ndcg: 0.706196
2023-11-27 13:23:48, Top_3, Val:  recall: 0.876147, ndcg: 0.688774
2023-11-27 13:23:48, Top_3, Test: recall: 0.899083, ndcg: 0.738306
2023-11-27 13:23:48, Top_4, Val:  recall: 0.899083, ndcg: 0.698652
2023-11-27 13:23:48, Top_4, Test: recall: 0.926606, ndcg: 0.750159
2023-11-27 13:23:48, Top_5, Val:  recall: 0.926606, ndcg: 0.709299
2023-11-27 13:23:48, Top_5, Test: recall: 0.949541, ndcg: 0.759032
{'data_path': './datasets', 'batch_size_train': 128, 'batch_size_test': 128, 'topk': [1, 2, 3, 4, 5], 'neg_num': 1, 'aug_type': 'ED', 'ed_interval': 1, 'embedding_sizes': [64], 'num_layerss': [1], 'item_level_ratios': [0.2], 'bundle_level_ratios': [0.2], 'bundle_agg_ratios': [0.2], 'self_loop': False, 'lrs': [0.001], 'l2_regs': [0.0001], 'c_lambdas': [0.01], 'c_temps': [0.25], 'epochs': 30, 'UI_layers': [0.7, 0.3], 'seed': 2023, 'UB_coefs': [1, 1], 'UI_coefs': [1, 1], 'BI_coefs': [1, 1], 'sep': '\t', 'file_type': '.txt', 'topk_valid': 3, 'nhead': 3, 'extra_layer': True, 'dataset': 'food', 'model': 'CrossCBR', 'gpu': '0', 'info': '', 'num_users': 879, 'num_bundles': 1784, 'num_items': 3767, 'w1': 1.0, 'w2': 1.0, 'w3': 0.5, 'w4': 0.5, 'sw': 0.0, 'nw': 1.0, 'device': device(type='cpu'), 'l2_reg': 0.0001, 'embedding_size': 64, 'item_level_ratio': 0.2, 'bundle_level_ratio': 0.2, 'bundle_agg_ratio': 0.2, 'num_layers': 1, 'c_lambda': 0.01, 'c_temp': 0.25}
2023-11-27 19:10:22, Top_1, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 19:10:22, Top_1, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 19:10:22, Top_2, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 19:10:22, Top_2, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 19:10:22, Top_3, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 19:10:22, Top_3, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 19:10:22, Top_4, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 19:10:22, Top_4, Test: recall: 0.004587, ndcg: 0.001976
2023-11-27 19:10:22, Top_5, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 19:10:22, Top_5, Test: recall: 0.004587, ndcg: 0.001976
2023-11-27 19:10:24, Top_1, Val:  recall: 0.004587, ndcg: 0.004587
2023-11-27 19:10:24, Top_1, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 19:10:24, Top_2, Val:  recall: 0.004587, ndcg: 0.004587
2023-11-27 19:10:24, Top_2, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 19:10:24, Top_3, Val:  recall: 0.009174, ndcg: 0.006881
2023-11-27 19:10:24, Top_3, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 19:10:24, Top_4, Val:  recall: 0.009174, ndcg: 0.006881
2023-11-27 19:10:24, Top_4, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 19:10:24, Top_5, Val:  recall: 0.013761, ndcg: 0.008655
2023-11-27 19:10:24, Top_5, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 19:10:24, Best in epoch 1, TOP 1: REC_V=0.00459, NDCG_V=0.00459
2023-11-27 19:10:24, Best in epoch 1, TOP 1: REC_T=0.00000, NDCG_T=0.00000
2023-11-27 19:10:24, Best in epoch 1, TOP 2: REC_V=0.00459, NDCG_V=0.00459
2023-11-27 19:10:24, Best in epoch 1, TOP 2: REC_T=0.00000, NDCG_T=0.00000
2023-11-27 19:10:24, Best in epoch 1, TOP 3: REC_V=0.00917, NDCG_V=0.00688
2023-11-27 19:10:24, Best in epoch 1, TOP 3: REC_T=0.00000, NDCG_T=0.00000
2023-11-27 19:10:24, Best in epoch 1, TOP 4: REC_V=0.00917, NDCG_V=0.00688
2023-11-27 19:10:24, Best in epoch 1, TOP 4: REC_T=0.00000, NDCG_T=0.00000
2023-11-27 19:10:24, Best in epoch 1, TOP 5: REC_V=0.01376, NDCG_V=0.00866
2023-11-27 19:10:24, Best in epoch 1, TOP 5: REC_T=0.00000, NDCG_T=0.00000
2023-11-27 19:10:26, Top_1, Val:  recall: 0.009174, ndcg: 0.009174
2023-11-27 19:10:26, Top_1, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 19:10:26, Top_2, Val:  recall: 0.018349, ndcg: 0.014963
2023-11-27 19:10:26, Top_2, Test: recall: 0.009174, ndcg: 0.005788
2023-11-27 19:10:26, Top_3, Val:  recall: 0.022936, ndcg: 0.017256
2023-11-27 19:10:26, Top_3, Test: recall: 0.013761, ndcg: 0.008082
2023-11-27 19:10:26, Top_4, Val:  recall: 0.032110, ndcg: 0.021207
2023-11-27 19:10:26, Top_4, Test: recall: 0.022936, ndcg: 0.012033
2023-11-27 19:10:26, Top_5, Val:  recall: 0.055046, ndcg: 0.030080
2023-11-27 19:10:26, Top_5, Test: recall: 0.032110, ndcg: 0.015582
2023-11-27 19:10:26, Best in epoch 2, TOP 1: REC_V=0.00917, NDCG_V=0.00917
2023-11-27 19:10:26, Best in epoch 2, TOP 1: REC_T=0.00000, NDCG_T=0.00000
2023-11-27 19:10:26, Best in epoch 2, TOP 2: REC_V=0.01835, NDCG_V=0.01496
2023-11-27 19:10:26, Best in epoch 2, TOP 2: REC_T=0.00917, NDCG_T=0.00579
2023-11-27 19:10:26, Best in epoch 2, TOP 3: REC_V=0.02294, NDCG_V=0.01726
2023-11-27 19:10:26, Best in epoch 2, TOP 3: REC_T=0.01376, NDCG_T=0.00808
2023-11-27 19:10:26, Best in epoch 2, TOP 4: REC_V=0.03211, NDCG_V=0.02121
2023-11-27 19:10:26, Best in epoch 2, TOP 4: REC_T=0.02294, NDCG_T=0.01203
2023-11-27 19:10:26, Best in epoch 2, TOP 5: REC_V=0.05505, NDCG_V=0.03008
2023-11-27 19:10:26, Best in epoch 2, TOP 5: REC_T=0.03211, NDCG_T=0.01558
2023-11-27 19:10:28, Top_1, Val:  recall: 0.027523, ndcg: 0.027523
2023-11-27 19:10:28, Top_1, Test: recall: 0.022936, ndcg: 0.022936
2023-11-27 19:10:28, Top_2, Val:  recall: 0.077982, ndcg: 0.059359
2023-11-27 19:10:28, Top_2, Test: recall: 0.036697, ndcg: 0.031618
2023-11-27 19:10:28, Top_3, Val:  recall: 0.114679, ndcg: 0.077707
2023-11-27 19:10:28, Top_3, Test: recall: 0.087156, ndcg: 0.056848
2023-11-27 19:10:28, Top_4, Val:  recall: 0.169725, ndcg: 0.101414
2023-11-27 19:10:28, Top_4, Test: recall: 0.137615, ndcg: 0.078579
2023-11-27 19:10:28, Top_5, Val:  recall: 0.197248, ndcg: 0.112062
2023-11-27 19:10:28, Top_5, Test: recall: 0.188073, ndcg: 0.098099
2023-11-27 19:10:28, Best in epoch 3, TOP 1: REC_V=0.02752, NDCG_V=0.02752
2023-11-27 19:10:28, Best in epoch 3, TOP 1: REC_T=0.02294, NDCG_T=0.02294
2023-11-27 19:10:28, Best in epoch 3, TOP 2: REC_V=0.07798, NDCG_V=0.05936
2023-11-27 19:10:28, Best in epoch 3, TOP 2: REC_T=0.03670, NDCG_T=0.03162
2023-11-27 19:10:28, Best in epoch 3, TOP 3: REC_V=0.11468, NDCG_V=0.07771
2023-11-27 19:10:28, Best in epoch 3, TOP 3: REC_T=0.08716, NDCG_T=0.05685
2023-11-27 19:10:28, Best in epoch 3, TOP 4: REC_V=0.16972, NDCG_V=0.10141
2023-11-27 19:10:28, Best in epoch 3, TOP 4: REC_T=0.13761, NDCG_T=0.07858
2023-11-27 19:10:28, Best in epoch 3, TOP 5: REC_V=0.19725, NDCG_V=0.11206
2023-11-27 19:10:28, Best in epoch 3, TOP 5: REC_T=0.18807, NDCG_T=0.09810
2023-11-27 19:10:30, Top_1, Val:  recall: 0.096330, ndcg: 0.096330
2023-11-27 19:10:30, Top_1, Test: recall: 0.045872, ndcg: 0.045872
2023-11-27 19:10:30, Top_2, Val:  recall: 0.192661, ndcg: 0.157108
2023-11-27 19:10:30, Top_2, Test: recall: 0.133028, ndcg: 0.100861
2023-11-27 19:10:30, Top_3, Val:  recall: 0.243119, ndcg: 0.182337
2023-11-27 19:10:30, Top_3, Test: recall: 0.215596, ndcg: 0.142145
2023-11-27 19:10:30, Top_4, Val:  recall: 0.275229, ndcg: 0.196166
2023-11-27 19:10:30, Top_4, Test: recall: 0.270642, ndcg: 0.165852
2023-11-27 19:10:30, Top_5, Val:  recall: 0.307339, ndcg: 0.208588
2023-11-27 19:10:30, Top_5, Test: recall: 0.330275, ndcg: 0.188921
2023-11-27 19:10:30, Best in epoch 4, TOP 1: REC_V=0.09633, NDCG_V=0.09633
2023-11-27 19:10:30, Best in epoch 4, TOP 1: REC_T=0.04587, NDCG_T=0.04587
2023-11-27 19:10:30, Best in epoch 4, TOP 2: REC_V=0.19266, NDCG_V=0.15711
2023-11-27 19:10:30, Best in epoch 4, TOP 2: REC_T=0.13303, NDCG_T=0.10086
2023-11-27 19:10:30, Best in epoch 4, TOP 3: REC_V=0.24312, NDCG_V=0.18234
2023-11-27 19:10:30, Best in epoch 4, TOP 3: REC_T=0.21560, NDCG_T=0.14215
2023-11-27 19:10:30, Best in epoch 4, TOP 4: REC_V=0.27523, NDCG_V=0.19617
2023-11-27 19:10:30, Best in epoch 4, TOP 4: REC_T=0.27064, NDCG_T=0.16585
2023-11-27 19:10:30, Best in epoch 4, TOP 5: REC_V=0.30734, NDCG_V=0.20859
2023-11-27 19:10:30, Best in epoch 4, TOP 5: REC_T=0.33028, NDCG_T=0.18892
{'data_path': './datasets', 'batch_size_train': 128, 'batch_size_test': 128, 'topk': [1, 2, 3, 4, 5], 'neg_num': 1, 'aug_type': 'ED', 'ed_interval': 1, 'embedding_sizes': [64], 'num_layerss': [1], 'item_level_ratios': [0.2], 'bundle_level_ratios': [0.2], 'bundle_agg_ratios': [0.2], 'self_loop': False, 'lrs': [0.001], 'l2_regs': [0.0001], 'c_lambdas': [0.01], 'c_temps': [0.25], 'epochs': 30, 'UI_layers': [0.7, 0.3], 'seed': 2023, 'UB_coefs': [1, 1], 'UI_coefs': [1, 1], 'BI_coefs': [1, 1], 'sep': '\t', 'file_type': '.txt', 'topk_valid': 3, 'nhead': 3, 'extra_layer': True, 'dataset': 'food', 'model': 'CrossCBR', 'gpu': '0', 'info': '', 'num_users': 879, 'num_bundles': 1784, 'num_items': 3767, 'w1': 1.0, 'w2': 1.0, 'w3': 0.5, 'w4': 0.5, 'sw': 0.0, 'nw': 1.0, 'device': device(type='cpu'), 'l2_reg': 0.0001, 'embedding_size': 64, 'item_level_ratio': 0.2, 'bundle_level_ratio': 0.2, 'bundle_agg_ratio': 0.2, 'num_layers': 1, 'c_lambda': 0.01, 'c_temp': 0.25}
2023-11-27 19:11:02, Top_1, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 19:11:02, Top_1, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 19:11:02, Top_2, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 19:11:02, Top_2, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 19:11:02, Top_3, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 19:11:02, Top_3, Test: recall: 0.000000, ndcg: 0.000000
2023-11-27 19:11:02, Top_4, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 19:11:02, Top_4, Test: recall: 0.004587, ndcg: 0.001976
2023-11-27 19:11:02, Top_5, Val:  recall: 0.000000, ndcg: 0.000000
2023-11-27 19:11:02, Top_5, Test: recall: 0.004587, ndcg: 0.001976
{'data_path': './datasets', 'batch_size_train': 128, 'batch_size_test': 128, 'topk': [1, 2, 3, 4, 5], 'neg_num': 1, 'aug_type': 'ED', 'ed_interval': 1, 'embedding_sizes': [64], 'num_layerss': [1], 'item_level_ratios': [0.2], 'bundle_level_ratios': [0.2], 'bundle_agg_ratios': [0.2], 'self_loop': False, 'lrs': [0.001], 'l2_regs': [0.0001], 'c_lambdas': [0.01], 'c_temps': [0.25], 'epochs': 30, 'UI_layers': [0.7, 0.3], 'seed': 2023, 'UB_coefs': [1, 1], 'UI_coefs': [1, 1], 'BI_coefs': [1, 1], 'sep': '\t', 'file_type': '.txt', 'topk_valid': 3, 'nhead': 3, 'extra_layer': True, 'dataset': 'food', 'model': 'CrossCBR', 'gpu': '0', 'info': '', 'num_users': 879, 'num_bundles': 1784, 'num_items': 3767, 'w1': 1.0, 'w2': 1.0, 'w3': 0.1, 'w4': 0.1, 'sw': 0.9, 'nw': 0.8, 'device': device(type='cpu'), 'l2_reg': 0.0001, 'embedding_size': 64, 'item_level_ratio': 0.2, 'bundle_level_ratio': 0.2, 'bundle_agg_ratio': 0.2, 'num_layers': 1, 'c_lambda': 0.01, 'c_temp': 0.25}
2023-11-27 19:11:17, Top_1, Val:  recall: 0.087156, ndcg: 0.087156
2023-11-27 19:11:17, Top_1, Test: recall: 0.114679, ndcg: 0.114679
2023-11-27 19:11:17, Top_2, Val:  recall: 0.192661, ndcg: 0.153722
2023-11-27 19:11:17, Top_2, Test: recall: 0.151376, ndcg: 0.137832
2023-11-27 19:11:17, Top_3, Val:  recall: 0.233945, ndcg: 0.174364
2023-11-27 19:11:17, Top_3, Test: recall: 0.206422, ndcg: 0.165355
2023-11-27 19:11:17, Top_4, Val:  recall: 0.252294, ndcg: 0.182266
2023-11-27 19:11:17, Top_4, Test: recall: 0.266055, ndcg: 0.191038
2023-11-27 19:11:17, Top_5, Val:  recall: 0.307339, ndcg: 0.203561
2023-11-27 19:11:17, Top_5, Test: recall: 0.321101, ndcg: 0.212332
2023-11-27 19:11:17, Best in epoch 0, TOP 1: REC_V=0.08716, NDCG_V=0.08716
2023-11-27 19:11:17, Best in epoch 0, TOP 1: REC_T=0.11468, NDCG_T=0.11468
2023-11-27 19:11:17, Best in epoch 0, TOP 2: REC_V=0.19266, NDCG_V=0.15372
2023-11-27 19:11:17, Best in epoch 0, TOP 2: REC_T=0.15138, NDCG_T=0.13783
2023-11-27 19:11:17, Best in epoch 0, TOP 3: REC_V=0.23394, NDCG_V=0.17436
2023-11-27 19:11:17, Best in epoch 0, TOP 3: REC_T=0.20642, NDCG_T=0.16536
2023-11-27 19:11:17, Best in epoch 0, TOP 4: REC_V=0.25229, NDCG_V=0.18227
2023-11-27 19:11:17, Best in epoch 0, TOP 4: REC_T=0.26606, NDCG_T=0.19104
2023-11-27 19:11:17, Best in epoch 0, TOP 5: REC_V=0.30734, NDCG_V=0.20356
2023-11-27 19:11:17, Best in epoch 0, TOP 5: REC_T=0.32110, NDCG_T=0.21233
2023-11-27 19:11:19, Top_1, Val:  recall: 0.233945, ndcg: 0.233945
2023-11-27 19:11:19, Top_1, Test: recall: 0.243119, ndcg: 0.243119
2023-11-27 19:11:19, Top_2, Val:  recall: 0.399083, ndcg: 0.338135
2023-11-27 19:11:19, Top_2, Test: recall: 0.399083, ndcg: 0.341521
2023-11-27 19:11:19, Top_3, Val:  recall: 0.458716, ndcg: 0.367952
2023-11-27 19:11:19, Top_3, Test: recall: 0.467890, ndcg: 0.375925
2023-11-27 19:11:19, Top_4, Val:  recall: 0.536697, ndcg: 0.401537
2023-11-27 19:11:19, Top_4, Test: recall: 0.559633, ndcg: 0.415436
2023-11-27 19:11:19, Top_5, Val:  recall: 0.587156, ndcg: 0.421057
2023-11-27 19:11:19, Top_5, Test: recall: 0.614679, ndcg: 0.436731
2023-11-27 19:11:19, Best in epoch 1, TOP 1: REC_V=0.23394, NDCG_V=0.23394
2023-11-27 19:11:19, Best in epoch 1, TOP 1: REC_T=0.24312, NDCG_T=0.24312
2023-11-27 19:11:19, Best in epoch 1, TOP 2: REC_V=0.39908, NDCG_V=0.33814
2023-11-27 19:11:19, Best in epoch 1, TOP 2: REC_T=0.39908, NDCG_T=0.34152
2023-11-27 19:11:19, Best in epoch 1, TOP 3: REC_V=0.45872, NDCG_V=0.36795
2023-11-27 19:11:19, Best in epoch 1, TOP 3: REC_T=0.46789, NDCG_T=0.37592
2023-11-27 19:11:19, Best in epoch 1, TOP 4: REC_V=0.53670, NDCG_V=0.40154
2023-11-27 19:11:19, Best in epoch 1, TOP 4: REC_T=0.55963, NDCG_T=0.41544
2023-11-27 19:11:19, Best in epoch 1, TOP 5: REC_V=0.58716, NDCG_V=0.42106
2023-11-27 19:11:19, Best in epoch 1, TOP 5: REC_T=0.61468, NDCG_T=0.43673
2023-11-27 19:11:21, Top_1, Val:  recall: 0.330275, ndcg: 0.330275
2023-11-27 19:11:21, Top_1, Test: recall: 0.339450, ndcg: 0.339450
2023-11-27 19:11:21, Top_2, Val:  recall: 0.573394, ndcg: 0.483666
2023-11-27 19:11:21, Top_2, Test: recall: 0.610092, ndcg: 0.510206
2023-11-27 19:11:21, Top_3, Val:  recall: 0.651376, ndcg: 0.522657
2023-11-27 19:11:21, Top_3, Test: recall: 0.701835, ndcg: 0.556077
2023-11-27 19:11:21, Top_4, Val:  recall: 0.743119, ndcg: 0.562169
2023-11-27 19:11:21, Top_4, Test: recall: 0.766055, ndcg: 0.583735
2023-11-27 19:11:21, Top_5, Val:  recall: 0.784404, ndcg: 0.578140
2023-11-27 19:11:21, Top_5, Test: recall: 0.811927, ndcg: 0.601481
2023-11-27 19:11:21, Best in epoch 2, TOP 1: REC_V=0.33028, NDCG_V=0.33028
2023-11-27 19:11:21, Best in epoch 2, TOP 1: REC_T=0.33945, NDCG_T=0.33945
2023-11-27 19:11:21, Best in epoch 2, TOP 2: REC_V=0.57339, NDCG_V=0.48367
2023-11-27 19:11:21, Best in epoch 2, TOP 2: REC_T=0.61009, NDCG_T=0.51021
2023-11-27 19:11:21, Best in epoch 2, TOP 3: REC_V=0.65138, NDCG_V=0.52266
2023-11-27 19:11:21, Best in epoch 2, TOP 3: REC_T=0.70183, NDCG_T=0.55608
2023-11-27 19:11:21, Best in epoch 2, TOP 4: REC_V=0.74312, NDCG_V=0.56217
2023-11-27 19:11:21, Best in epoch 2, TOP 4: REC_T=0.76606, NDCG_T=0.58374
2023-11-27 19:11:21, Best in epoch 2, TOP 5: REC_V=0.78440, NDCG_V=0.57814
2023-11-27 19:11:21, Best in epoch 2, TOP 5: REC_T=0.81193, NDCG_T=0.60148
2023-11-27 19:11:23, Top_1, Val:  recall: 0.366972, ndcg: 0.366972
2023-11-27 19:11:23, Top_1, Test: recall: 0.399083, ndcg: 0.399083
2023-11-27 19:11:23, Top_2, Val:  recall: 0.688073, ndcg: 0.569565
2023-11-27 19:11:23, Top_2, Test: recall: 0.701835, ndcg: 0.590098
2023-11-27 19:11:23, Top_3, Val:  recall: 0.788991, ndcg: 0.620023
2023-11-27 19:11:23, Top_3, Test: recall: 0.802752, ndcg: 0.640557
2023-11-27 19:11:23, Top_4, Val:  recall: 0.834862, ndcg: 0.639779
2023-11-27 19:11:23, Top_4, Test: recall: 0.853211, ndcg: 0.662288
2023-11-27 19:11:23, Top_5, Val:  recall: 0.857798, ndcg: 0.648652
2023-11-27 19:11:23, Top_5, Test: recall: 0.885321, ndcg: 0.674710
2023-11-27 19:11:23, Best in epoch 3, TOP 1: REC_V=0.36697, NDCG_V=0.36697
2023-11-27 19:11:23, Best in epoch 3, TOP 1: REC_T=0.39908, NDCG_T=0.39908
2023-11-27 19:11:23, Best in epoch 3, TOP 2: REC_V=0.68807, NDCG_V=0.56956
2023-11-27 19:11:23, Best in epoch 3, TOP 2: REC_T=0.70183, NDCG_T=0.59010
2023-11-27 19:11:23, Best in epoch 3, TOP 3: REC_V=0.78899, NDCG_V=0.62002
2023-11-27 19:11:23, Best in epoch 3, TOP 3: REC_T=0.80275, NDCG_T=0.64056
2023-11-27 19:11:23, Best in epoch 3, TOP 4: REC_V=0.83486, NDCG_V=0.63978
2023-11-27 19:11:23, Best in epoch 3, TOP 4: REC_T=0.85321, NDCG_T=0.66229
2023-11-27 19:11:23, Best in epoch 3, TOP 5: REC_V=0.85780, NDCG_V=0.64865
2023-11-27 19:11:23, Best in epoch 3, TOP 5: REC_T=0.88532, NDCG_T=0.67471
2023-11-27 19:11:24, Top_1, Val:  recall: 0.380734, ndcg: 0.380734
2023-11-27 19:11:24, Top_1, Test: recall: 0.431193, ndcg: 0.431193
2023-11-27 19:11:24, Top_2, Val:  recall: 0.761468, ndcg: 0.620950
2023-11-27 19:11:24, Top_2, Test: recall: 0.752294, ndcg: 0.633785
2023-11-27 19:11:24, Top_3, Val:  recall: 0.821101, ndcg: 0.650767
2023-11-27 19:11:24, Top_3, Test: recall: 0.857798, ndcg: 0.686537
2023-11-27 19:11:24, Top_4, Val:  recall: 0.866972, ndcg: 0.670523
2023-11-27 19:11:24, Top_4, Test: recall: 0.899083, ndcg: 0.704317
2023-11-27 19:11:24, Top_5, Val:  recall: 0.889908, ndcg: 0.679395
2023-11-27 19:11:24, Top_5, Test: recall: 0.917431, ndcg: 0.711416
2023-11-27 19:11:24, Best in epoch 4, TOP 1: REC_V=0.38073, NDCG_V=0.38073
2023-11-27 19:11:24, Best in epoch 4, TOP 1: REC_T=0.43119, NDCG_T=0.43119
2023-11-27 19:11:24, Best in epoch 4, TOP 2: REC_V=0.76147, NDCG_V=0.62095
2023-11-27 19:11:24, Best in epoch 4, TOP 2: REC_T=0.75229, NDCG_T=0.63378
2023-11-27 19:11:24, Best in epoch 4, TOP 3: REC_V=0.82110, NDCG_V=0.65077
2023-11-27 19:11:24, Best in epoch 4, TOP 3: REC_T=0.85780, NDCG_T=0.68654
2023-11-27 19:11:24, Best in epoch 4, TOP 4: REC_V=0.86697, NDCG_V=0.67052
2023-11-27 19:11:24, Best in epoch 4, TOP 4: REC_T=0.89908, NDCG_T=0.70432
2023-11-27 19:11:24, Best in epoch 4, TOP 5: REC_V=0.88991, NDCG_V=0.67940
2023-11-27 19:11:24, Best in epoch 4, TOP 5: REC_T=0.91743, NDCG_T=0.71142
2023-11-27 19:11:26, Top_1, Val:  recall: 0.408257, ndcg: 0.408257
2023-11-27 19:11:26, Top_1, Test: recall: 0.449541, ndcg: 0.449541
2023-11-27 19:11:26, Top_2, Val:  recall: 0.766055, ndcg: 0.634002
2023-11-27 19:11:26, Top_2, Test: recall: 0.779817, ndcg: 0.657922
2023-11-27 19:11:26, Top_3, Val:  recall: 0.848624, ndcg: 0.675287
2023-11-27 19:11:26, Top_3, Test: recall: 0.885321, ndcg: 0.710674
2023-11-27 19:11:26, Top_4, Val:  recall: 0.889908, ndcg: 0.693067
2023-11-27 19:11:26, Top_4, Test: recall: 0.917431, ndcg: 0.724503
2023-11-27 19:11:26, Top_5, Val:  recall: 0.889908, ndcg: 0.693067
2023-11-27 19:11:26, Top_5, Test: recall: 0.944954, ndcg: 0.735150
2023-11-27 19:11:26, Best in epoch 5, TOP 1: REC_V=0.40826, NDCG_V=0.40826
2023-11-27 19:11:26, Best in epoch 5, TOP 1: REC_T=0.44954, NDCG_T=0.44954
2023-11-27 19:11:26, Best in epoch 5, TOP 2: REC_V=0.76606, NDCG_V=0.63400
2023-11-27 19:11:26, Best in epoch 5, TOP 2: REC_T=0.77982, NDCG_T=0.65792
2023-11-27 19:11:26, Best in epoch 5, TOP 3: REC_V=0.84862, NDCG_V=0.67529
2023-11-27 19:11:26, Best in epoch 5, TOP 3: REC_T=0.88532, NDCG_T=0.71067
2023-11-27 19:11:26, Best in epoch 5, TOP 4: REC_V=0.88991, NDCG_V=0.69307
2023-11-27 19:11:26, Best in epoch 5, TOP 4: REC_T=0.91743, NDCG_T=0.72450
2023-11-27 19:11:26, Best in epoch 5, TOP 5: REC_V=0.88991, NDCG_V=0.69307
2023-11-27 19:11:26, Best in epoch 5, TOP 5: REC_T=0.94495, NDCG_T=0.73515
2023-11-27 19:11:28, Top_1, Val:  recall: 0.426606, ndcg: 0.426606
2023-11-27 19:11:28, Top_1, Test: recall: 0.449541, ndcg: 0.449541
2023-11-27 19:11:28, Top_2, Val:  recall: 0.788991, ndcg: 0.655245
2023-11-27 19:11:28, Top_2, Test: recall: 0.821101, ndcg: 0.683969
2023-11-27 19:11:28, Top_3, Val:  recall: 0.862385, ndcg: 0.691942
2023-11-27 19:11:28, Top_3, Test: recall: 0.894495, ndcg: 0.720667
2023-11-27 19:11:28, Top_4, Val:  recall: 0.903670, ndcg: 0.709723
2023-11-27 19:11:28, Top_4, Test: recall: 0.922018, ndcg: 0.732520
2023-11-27 19:11:28, Top_5, Val:  recall: 0.908257, ndcg: 0.711497
2023-11-27 19:11:28, Top_5, Test: recall: 0.949541, ndcg: 0.743167
2023-11-27 19:11:28, Best in epoch 6, TOP 1: REC_V=0.42661, NDCG_V=0.42661
2023-11-27 19:11:28, Best in epoch 6, TOP 1: REC_T=0.44954, NDCG_T=0.44954
2023-11-27 19:11:28, Best in epoch 6, TOP 2: REC_V=0.78899, NDCG_V=0.65525
2023-11-27 19:11:28, Best in epoch 6, TOP 2: REC_T=0.82110, NDCG_T=0.68397
2023-11-27 19:11:28, Best in epoch 6, TOP 3: REC_V=0.86239, NDCG_V=0.69194
2023-11-27 19:11:28, Best in epoch 6, TOP 3: REC_T=0.89450, NDCG_T=0.72067
2023-11-27 19:11:28, Best in epoch 6, TOP 4: REC_V=0.90367, NDCG_V=0.70972
2023-11-27 19:11:28, Best in epoch 6, TOP 4: REC_T=0.92202, NDCG_T=0.73252
2023-11-27 19:11:28, Best in epoch 6, TOP 5: REC_V=0.90826, NDCG_V=0.71150
2023-11-27 19:11:28, Best in epoch 6, TOP 5: REC_T=0.94954, NDCG_T=0.74317
2023-11-27 19:11:30, Top_1, Val:  recall: 0.435780, ndcg: 0.435780
2023-11-27 19:11:30, Top_1, Test: recall: 0.463303, ndcg: 0.463303
2023-11-27 19:11:30, Top_2, Val:  recall: 0.811927, ndcg: 0.673102
2023-11-27 19:11:30, Top_2, Test: recall: 0.839450, ndcg: 0.700625
2023-11-27 19:11:30, Top_3, Val:  recall: 0.871560, ndcg: 0.702919
2023-11-27 19:11:30, Top_3, Test: recall: 0.899083, ndcg: 0.730441
2023-11-27 19:11:30, Top_4, Val:  recall: 0.908257, ndcg: 0.718723
2023-11-27 19:11:30, Top_4, Test: recall: 0.926606, ndcg: 0.742295
2023-11-27 19:11:30, Top_5, Val:  recall: 0.922018, ndcg: 0.724047
2023-11-27 19:11:30, Top_5, Test: recall: 0.944954, ndcg: 0.749393
2023-11-27 19:11:30, Best in epoch 7, TOP 1: REC_V=0.43578, NDCG_V=0.43578
2023-11-27 19:11:30, Best in epoch 7, TOP 1: REC_T=0.46330, NDCG_T=0.46330
2023-11-27 19:11:30, Best in epoch 7, TOP 2: REC_V=0.81193, NDCG_V=0.67310
2023-11-27 19:11:30, Best in epoch 7, TOP 2: REC_T=0.83945, NDCG_T=0.70062
2023-11-27 19:11:30, Best in epoch 7, TOP 3: REC_V=0.87156, NDCG_V=0.70292
2023-11-27 19:11:30, Best in epoch 7, TOP 3: REC_T=0.89908, NDCG_T=0.73044
2023-11-27 19:11:30, Best in epoch 7, TOP 4: REC_V=0.90826, NDCG_V=0.71872
2023-11-27 19:11:30, Best in epoch 7, TOP 4: REC_T=0.92661, NDCG_T=0.74229
2023-11-27 19:11:30, Best in epoch 7, TOP 5: REC_V=0.92202, NDCG_V=0.72405
2023-11-27 19:11:30, Best in epoch 7, TOP 5: REC_T=0.94495, NDCG_T=0.74939
2023-11-27 19:11:31, Top_1, Val:  recall: 0.426606, ndcg: 0.426606
2023-11-27 19:11:31, Top_1, Test: recall: 0.458716, ndcg: 0.458716
2023-11-27 19:11:31, Top_2, Val:  recall: 0.802752, ndcg: 0.663928
2023-11-27 19:11:31, Top_2, Test: recall: 0.839450, ndcg: 0.698932
2023-11-27 19:11:31, Top_3, Val:  recall: 0.880734, ndcg: 0.702919
2023-11-27 19:11:31, Top_3, Test: recall: 0.889908, ndcg: 0.724161
2023-11-27 19:11:31, Top_4, Val:  recall: 0.912844, ndcg: 0.716748
2023-11-27 19:11:31, Top_4, Test: recall: 0.926606, ndcg: 0.739966
2023-11-27 19:11:31, Top_5, Val:  recall: 0.926606, ndcg: 0.722071
2023-11-27 19:11:31, Top_5, Test: recall: 0.944954, ndcg: 0.747064
2023-11-27 19:11:33, Top_1, Val:  recall: 0.417431, ndcg: 0.417431
2023-11-27 19:11:33, Top_1, Test: recall: 0.467890, ndcg: 0.467890
2023-11-27 19:11:33, Top_2, Val:  recall: 0.798165, ndcg: 0.657648
2023-11-27 19:11:33, Top_2, Test: recall: 0.848624, ndcg: 0.708106
2023-11-27 19:11:33, Top_3, Val:  recall: 0.880734, ndcg: 0.698932
2023-11-27 19:11:33, Top_3, Test: recall: 0.908257, ndcg: 0.737923
2023-11-27 19:11:33, Top_4, Val:  recall: 0.922018, ndcg: 0.716712
2023-11-27 19:11:33, Top_4, Test: recall: 0.931193, ndcg: 0.747801
2023-11-27 19:11:33, Top_5, Val:  recall: 0.931193, ndcg: 0.720261
2023-11-27 19:11:33, Top_5, Test: recall: 0.949541, ndcg: 0.754899
2023-11-27 19:11:35, Top_1, Val:  recall: 0.417431, ndcg: 0.417431
2023-11-27 19:11:35, Top_1, Test: recall: 0.472477, ndcg: 0.472477
2023-11-27 19:11:35, Top_2, Val:  recall: 0.807339, ndcg: 0.663436
2023-11-27 19:11:35, Top_2, Test: recall: 0.853211, ndcg: 0.712693
2023-11-27 19:11:35, Top_3, Val:  recall: 0.876147, ndcg: 0.697840
2023-11-27 19:11:35, Top_3, Test: recall: 0.912844, ndcg: 0.742510
2023-11-27 19:11:35, Top_4, Val:  recall: 0.917431, ndcg: 0.715620
2023-11-27 19:11:35, Top_4, Test: recall: 0.944954, ndcg: 0.756339
2023-11-27 19:11:35, Top_5, Val:  recall: 0.922018, ndcg: 0.717394
2023-11-27 19:11:35, Top_5, Test: recall: 0.954128, ndcg: 0.759888
2023-11-27 19:11:37, Top_1, Val:  recall: 0.399083, ndcg: 0.399083
2023-11-27 19:11:37, Top_1, Test: recall: 0.472477, ndcg: 0.472477
2023-11-27 19:11:37, Top_2, Val:  recall: 0.779817, ndcg: 0.639299
2023-11-27 19:11:37, Top_2, Test: recall: 0.848624, ndcg: 0.709799
2023-11-27 19:11:37, Top_3, Val:  recall: 0.871560, ndcg: 0.685171
2023-11-27 19:11:37, Top_3, Test: recall: 0.908257, ndcg: 0.739616
2023-11-27 19:11:37, Top_4, Val:  recall: 0.917431, ndcg: 0.704926
2023-11-27 19:11:37, Top_4, Test: recall: 0.949541, ndcg: 0.757396
2023-11-27 19:11:37, Top_5, Val:  recall: 0.922018, ndcg: 0.706701
2023-11-27 19:11:37, Top_5, Test: recall: 0.958716, ndcg: 0.760945
2023-11-27 19:11:39, Top_1, Val:  recall: 0.394495, ndcg: 0.394495
2023-11-27 19:11:39, Top_1, Test: recall: 0.481651, ndcg: 0.481651
2023-11-27 19:11:39, Top_2, Val:  recall: 0.779817, ndcg: 0.637606
2023-11-27 19:11:39, Top_2, Test: recall: 0.853211, ndcg: 0.716079
2023-11-27 19:11:39, Top_3, Val:  recall: 0.862385, ndcg: 0.678890
2023-11-27 19:11:39, Top_3, Test: recall: 0.908257, ndcg: 0.743602
2023-11-27 19:11:39, Top_4, Val:  recall: 0.912844, ndcg: 0.700622
2023-11-27 19:11:39, Top_4, Test: recall: 0.949541, ndcg: 0.761383
2023-11-27 19:11:39, Top_5, Val:  recall: 0.922018, ndcg: 0.704171
2023-11-27 19:11:39, Top_5, Test: recall: 0.958716, ndcg: 0.764932
2023-11-27 19:11:40, Top_1, Val:  recall: 0.389908, ndcg: 0.389908
2023-11-27 19:11:40, Top_1, Test: recall: 0.477064, ndcg: 0.477064
2023-11-27 19:11:40, Top_2, Val:  recall: 0.770642, ndcg: 0.630125
2023-11-27 19:11:40, Top_2, Test: recall: 0.844037, ndcg: 0.708598
2023-11-27 19:11:40, Top_3, Val:  recall: 0.853211, ndcg: 0.671409
2023-11-27 19:11:40, Top_3, Test: recall: 0.912844, ndcg: 0.743002
2023-11-27 19:11:40, Top_4, Val:  recall: 0.912844, ndcg: 0.697092
2023-11-27 19:11:40, Top_4, Test: recall: 0.940367, ndcg: 0.754855
2023-11-27 19:11:40, Top_5, Val:  recall: 0.926606, ndcg: 0.702415
2023-11-27 19:11:40, Top_5, Test: recall: 0.958716, ndcg: 0.761953
2023-11-27 19:11:42, Top_1, Val:  recall: 0.376147, ndcg: 0.376147
2023-11-27 19:11:42, Top_1, Test: recall: 0.495413, ndcg: 0.495413
2023-11-27 19:11:42, Top_2, Val:  recall: 0.766055, ndcg: 0.622152
2023-11-27 19:11:42, Top_2, Test: recall: 0.839450, ndcg: 0.712476
2023-11-27 19:11:42, Top_3, Val:  recall: 0.857798, ndcg: 0.668023
2023-11-27 19:11:42, Top_3, Test: recall: 0.917431, ndcg: 0.751467
2023-11-27 19:11:42, Top_4, Val:  recall: 0.912844, ndcg: 0.691730
2023-11-27 19:11:42, Top_4, Test: recall: 0.944954, ndcg: 0.763320
2023-11-27 19:11:42, Top_5, Val:  recall: 0.931193, ndcg: 0.698828
2023-11-27 19:11:42, Top_5, Test: recall: 0.963303, ndcg: 0.770418
2023-11-27 19:11:44, Top_1, Val:  recall: 0.371560, ndcg: 0.371560
2023-11-27 19:11:44, Top_1, Test: recall: 0.486239, ndcg: 0.486239
2023-11-27 19:11:44, Top_2, Val:  recall: 0.761468, ndcg: 0.617564
2023-11-27 19:11:44, Top_2, Test: recall: 0.830275, ndcg: 0.703302
2023-11-27 19:11:44, Top_3, Val:  recall: 0.848624, ndcg: 0.661142
2023-11-27 19:11:44, Top_3, Test: recall: 0.922018, ndcg: 0.749173
2023-11-27 19:11:44, Top_4, Val:  recall: 0.917431, ndcg: 0.690776
2023-11-27 19:11:44, Top_4, Test: recall: 0.949541, ndcg: 0.761027
2023-11-27 19:11:44, Top_5, Val:  recall: 0.926606, ndcg: 0.694325
2023-11-27 19:11:44, Top_5, Test: recall: 0.963303, ndcg: 0.766350
{'data_path': './datasets', 'batch_size_train': 128, 'batch_size_test': 128, 'topk': [1, 2, 3, 4, 5], 'neg_num': 1, 'aug_type': 'ED', 'ed_interval': 1, 'embedding_sizes': [64], 'num_layerss': [1], 'item_level_ratios': [0.2], 'bundle_level_ratios': [0.2], 'bundle_agg_ratios': [0.2], 'self_loop': False, 'lrs': [0.001], 'l2_regs': [0.0001], 'c_lambdas': [0.01], 'c_temps': [0.25], 'epochs': 30, 'UI_layers': [0.7, 0.3], 'seed': 2023, 'UB_coefs': [1, 1], 'UI_coefs': [1, 1], 'BI_coefs': [1, 1], 'sep': '\t', 'file_type': '.txt', 'topk_valid': 3, 'nhead': 3, 'extra_layer': True, 'dataset': 'food', 'model': 'CrossCBR', 'gpu': '0', 'info': '', 'num_users': 879, 'num_bundles': 1784, 'num_items': 3767, 'w1': 1.0, 'w2': 1.0, 'w3': 0.1, 'w4': 0.1, 'sw': 0.9, 'nw': 0.1, 'device': device(type='cpu'), 'l2_reg': 0.0001, 'embedding_size': 64, 'item_level_ratio': 0.2, 'bundle_level_ratio': 0.2, 'bundle_agg_ratio': 0.2, 'num_layers': 1, 'c_lambda': 0.01, 'c_temp': 0.25}
2023-11-27 19:19:15, Top_1, Val:  recall: 0.110092, ndcg: 0.110092
2023-11-27 19:19:15, Top_1, Test: recall: 0.110092, ndcg: 0.110092
2023-11-27 19:19:15, Top_2, Val:  recall: 0.220183, ndcg: 0.179552
2023-11-27 19:19:15, Top_2, Test: recall: 0.211009, ndcg: 0.173764
2023-11-27 19:19:15, Top_3, Val:  recall: 0.284404, ndcg: 0.211662
2023-11-27 19:19:15, Top_3, Test: recall: 0.279817, ndcg: 0.208167
2023-11-27 19:19:15, Top_4, Val:  recall: 0.307339, ndcg: 0.221540
2023-11-27 19:19:15, Top_4, Test: recall: 0.344037, ndcg: 0.235825
2023-11-27 19:19:15, Top_5, Val:  recall: 0.353211, ndcg: 0.239285
2023-11-27 19:19:15, Top_5, Test: recall: 0.385321, ndcg: 0.251796
2023-11-27 19:19:15, Best in epoch 0, TOP 1: REC_V=0.11009, NDCG_V=0.11009
2023-11-27 19:19:15, Best in epoch 0, TOP 1: REC_T=0.11009, NDCG_T=0.11009
2023-11-27 19:19:15, Best in epoch 0, TOP 2: REC_V=0.22018, NDCG_V=0.17955
2023-11-27 19:19:15, Best in epoch 0, TOP 2: REC_T=0.21101, NDCG_T=0.17376
2023-11-27 19:19:15, Best in epoch 0, TOP 3: REC_V=0.28440, NDCG_V=0.21166
2023-11-27 19:19:15, Best in epoch 0, TOP 3: REC_T=0.27982, NDCG_T=0.20817
2023-11-27 19:19:15, Best in epoch 0, TOP 4: REC_V=0.30734, NDCG_V=0.22154
2023-11-27 19:19:15, Best in epoch 0, TOP 4: REC_T=0.34404, NDCG_T=0.23583
2023-11-27 19:19:15, Best in epoch 0, TOP 5: REC_V=0.35321, NDCG_V=0.23929
2023-11-27 19:19:15, Best in epoch 0, TOP 5: REC_T=0.38532, NDCG_T=0.25180
2023-11-27 19:19:17, Top_1, Val:  recall: 0.256881, ndcg: 0.256881
2023-11-27 19:19:17, Top_1, Test: recall: 0.266055, ndcg: 0.266055
2023-11-27 19:19:17, Top_2, Val:  recall: 0.449541, ndcg: 0.378436
2023-11-27 19:19:17, Top_2, Test: recall: 0.449541, ndcg: 0.381822
2023-11-27 19:19:17, Top_3, Val:  recall: 0.522936, ndcg: 0.415133
2023-11-27 19:19:17, Top_3, Test: recall: 0.527523, ndcg: 0.420813
2023-11-27 19:19:17, Top_4, Val:  recall: 0.587156, ndcg: 0.442791
2023-11-27 19:19:17, Top_4, Test: recall: 0.628440, ndcg: 0.464276
2023-11-27 19:19:17, Top_5, Val:  recall: 0.619266, ndcg: 0.455213
2023-11-27 19:19:17, Top_5, Test: recall: 0.674312, ndcg: 0.482021
2023-11-27 19:19:17, Best in epoch 1, TOP 1: REC_V=0.25688, NDCG_V=0.25688
2023-11-27 19:19:17, Best in epoch 1, TOP 1: REC_T=0.26606, NDCG_T=0.26606
2023-11-27 19:19:17, Best in epoch 1, TOP 2: REC_V=0.44954, NDCG_V=0.37844
2023-11-27 19:19:17, Best in epoch 1, TOP 2: REC_T=0.44954, NDCG_T=0.38182
2023-11-27 19:19:17, Best in epoch 1, TOP 3: REC_V=0.52294, NDCG_V=0.41513
2023-11-27 19:19:17, Best in epoch 1, TOP 3: REC_T=0.52752, NDCG_T=0.42081
2023-11-27 19:19:17, Best in epoch 1, TOP 4: REC_V=0.58716, NDCG_V=0.44279
2023-11-27 19:19:17, Best in epoch 1, TOP 4: REC_T=0.62844, NDCG_T=0.46428
2023-11-27 19:19:17, Best in epoch 1, TOP 5: REC_V=0.61927, NDCG_V=0.45521
2023-11-27 19:19:17, Best in epoch 1, TOP 5: REC_T=0.67431, NDCG_T=0.48202
2023-11-27 19:19:18, Top_1, Val:  recall: 0.325688, ndcg: 0.325688
2023-11-27 19:19:18, Top_1, Test: recall: 0.353211, ndcg: 0.353211
2023-11-27 19:19:18, Top_2, Val:  recall: 0.587156, ndcg: 0.490656
2023-11-27 19:19:18, Top_2, Test: recall: 0.619266, ndcg: 0.521073
2023-11-27 19:19:18, Top_3, Val:  recall: 0.674312, ndcg: 0.534234
2023-11-27 19:19:18, Top_3, Test: recall: 0.711009, ndcg: 0.566945
2023-11-27 19:19:18, Top_4, Val:  recall: 0.756881, ndcg: 0.569794
2023-11-27 19:19:18, Top_4, Test: recall: 0.766055, ndcg: 0.590652
2023-11-27 19:19:18, Top_5, Val:  recall: 0.816514, ndcg: 0.592864
2023-11-27 19:19:18, Top_5, Test: recall: 0.802752, ndcg: 0.604848
2023-11-27 19:19:18, Best in epoch 2, TOP 1: REC_V=0.32569, NDCG_V=0.32569
2023-11-27 19:19:18, Best in epoch 2, TOP 1: REC_T=0.35321, NDCG_T=0.35321
2023-11-27 19:19:18, Best in epoch 2, TOP 2: REC_V=0.58716, NDCG_V=0.49066
2023-11-27 19:19:18, Best in epoch 2, TOP 2: REC_T=0.61927, NDCG_T=0.52107
2023-11-27 19:19:18, Best in epoch 2, TOP 3: REC_V=0.67431, NDCG_V=0.53423
2023-11-27 19:19:18, Best in epoch 2, TOP 3: REC_T=0.71101, NDCG_T=0.56694
2023-11-27 19:19:18, Best in epoch 2, TOP 4: REC_V=0.75688, NDCG_V=0.56979
2023-11-27 19:19:18, Best in epoch 2, TOP 4: REC_T=0.76606, NDCG_T=0.59065
2023-11-27 19:19:18, Best in epoch 2, TOP 5: REC_V=0.81651, NDCG_V=0.59286
2023-11-27 19:19:18, Best in epoch 2, TOP 5: REC_T=0.80275, NDCG_T=0.60485
2023-11-27 19:19:20, Top_1, Val:  recall: 0.344037, ndcg: 0.344037
2023-11-27 19:19:20, Top_1, Test: recall: 0.412844, ndcg: 0.412844
2023-11-27 19:19:20, Top_2, Val:  recall: 0.706422, ndcg: 0.572676
2023-11-27 19:19:20, Top_2, Test: recall: 0.701835, ndcg: 0.595177
2023-11-27 19:19:20, Top_3, Val:  recall: 0.784404, ndcg: 0.611667
2023-11-27 19:19:20, Top_3, Test: recall: 0.793578, ndcg: 0.641049
2023-11-27 19:19:20, Top_4, Val:  recall: 0.830275, ndcg: 0.631423
2023-11-27 19:19:20, Top_4, Test: recall: 0.862385, ndcg: 0.670682
2023-11-27 19:19:20, Top_5, Val:  recall: 0.857798, ndcg: 0.642070
2023-11-27 19:19:20, Top_5, Test: recall: 0.894495, ndcg: 0.683104
2023-11-27 19:19:20, Best in epoch 3, TOP 1: REC_V=0.34404, NDCG_V=0.34404
2023-11-27 19:19:20, Best in epoch 3, TOP 1: REC_T=0.41284, NDCG_T=0.41284
2023-11-27 19:19:20, Best in epoch 3, TOP 2: REC_V=0.70642, NDCG_V=0.57268
2023-11-27 19:19:20, Best in epoch 3, TOP 2: REC_T=0.70183, NDCG_T=0.59518
2023-11-27 19:19:20, Best in epoch 3, TOP 3: REC_V=0.78440, NDCG_V=0.61167
2023-11-27 19:19:20, Best in epoch 3, TOP 3: REC_T=0.79358, NDCG_T=0.64105
2023-11-27 19:19:20, Best in epoch 3, TOP 4: REC_V=0.83028, NDCG_V=0.63142
2023-11-27 19:19:20, Best in epoch 3, TOP 4: REC_T=0.86239, NDCG_T=0.67068
2023-11-27 19:19:20, Best in epoch 3, TOP 5: REC_V=0.85780, NDCG_V=0.64207
2023-11-27 19:19:20, Best in epoch 3, TOP 5: REC_T=0.89450, NDCG_T=0.68310
2023-11-27 19:19:22, Top_1, Val:  recall: 0.385321, ndcg: 0.385321
2023-11-27 19:19:22, Top_1, Test: recall: 0.422018, ndcg: 0.422018
2023-11-27 19:19:22, Top_2, Val:  recall: 0.761468, ndcg: 0.622643
2023-11-27 19:19:22, Top_2, Test: recall: 0.756881, ndcg: 0.633293
2023-11-27 19:19:22, Top_3, Val:  recall: 0.821101, ndcg: 0.652460
2023-11-27 19:19:22, Top_3, Test: recall: 0.844037, ndcg: 0.676871
2023-11-27 19:19:22, Top_4, Val:  recall: 0.862385, ndcg: 0.670240
2023-11-27 19:19:22, Top_4, Test: recall: 0.894495, ndcg: 0.698602
2023-11-27 19:19:22, Top_5, Val:  recall: 0.894495, ndcg: 0.682662
2023-11-27 19:19:22, Top_5, Test: recall: 0.912844, ndcg: 0.705701
2023-11-27 19:19:22, Best in epoch 4, TOP 1: REC_V=0.38532, NDCG_V=0.38532
2023-11-27 19:19:22, Best in epoch 4, TOP 1: REC_T=0.42202, NDCG_T=0.42202
2023-11-27 19:19:22, Best in epoch 4, TOP 2: REC_V=0.76147, NDCG_V=0.62264
2023-11-27 19:19:22, Best in epoch 4, TOP 2: REC_T=0.75688, NDCG_T=0.63329
2023-11-27 19:19:22, Best in epoch 4, TOP 3: REC_V=0.82110, NDCG_V=0.65246
2023-11-27 19:19:22, Best in epoch 4, TOP 3: REC_T=0.84404, NDCG_T=0.67687
2023-11-27 19:19:22, Best in epoch 4, TOP 4: REC_V=0.86239, NDCG_V=0.67024
2023-11-27 19:19:22, Best in epoch 4, TOP 4: REC_T=0.89450, NDCG_T=0.69860
2023-11-27 19:19:22, Best in epoch 4, TOP 5: REC_V=0.89450, NDCG_V=0.68266
2023-11-27 19:19:22, Best in epoch 4, TOP 5: REC_T=0.91284, NDCG_T=0.70570
2023-11-27 19:19:24, Top_1, Val:  recall: 0.412844, ndcg: 0.412844
2023-11-27 19:19:24, Top_1, Test: recall: 0.435780, ndcg: 0.435780
2023-11-27 19:19:24, Top_2, Val:  recall: 0.770642, ndcg: 0.638590
2023-11-27 19:19:24, Top_2, Test: recall: 0.798165, ndcg: 0.664420
2023-11-27 19:19:24, Top_3, Val:  recall: 0.844037, ndcg: 0.675287
2023-11-27 19:19:24, Top_3, Test: recall: 0.876147, ndcg: 0.703410
2023-11-27 19:19:24, Top_4, Val:  recall: 0.880734, ndcg: 0.691091
2023-11-27 19:19:24, Top_4, Test: recall: 0.917431, ndcg: 0.721191
2023-11-27 19:19:24, Top_5, Val:  recall: 0.889908, ndcg: 0.694641
2023-11-27 19:19:24, Top_5, Test: recall: 0.926606, ndcg: 0.724740
2023-11-27 19:19:24, Best in epoch 5, TOP 1: REC_V=0.41284, NDCG_V=0.41284
2023-11-27 19:19:24, Best in epoch 5, TOP 1: REC_T=0.43578, NDCG_T=0.43578
2023-11-27 19:19:24, Best in epoch 5, TOP 2: REC_V=0.77064, NDCG_V=0.63859
2023-11-27 19:19:24, Best in epoch 5, TOP 2: REC_T=0.79817, NDCG_T=0.66442
2023-11-27 19:19:24, Best in epoch 5, TOP 3: REC_V=0.84404, NDCG_V=0.67529
2023-11-27 19:19:24, Best in epoch 5, TOP 3: REC_T=0.87615, NDCG_T=0.70341
2023-11-27 19:19:24, Best in epoch 5, TOP 4: REC_V=0.88073, NDCG_V=0.69109
2023-11-27 19:19:24, Best in epoch 5, TOP 4: REC_T=0.91743, NDCG_T=0.72119
2023-11-27 19:19:24, Best in epoch 5, TOP 5: REC_V=0.88991, NDCG_V=0.69464
2023-11-27 19:19:24, Best in epoch 5, TOP 5: REC_T=0.92661, NDCG_T=0.72474
2023-11-27 19:19:25, Top_1, Val:  recall: 0.417431, ndcg: 0.417431
2023-11-27 19:19:25, Top_1, Test: recall: 0.467890, ndcg: 0.467890
2023-11-27 19:19:25, Top_2, Val:  recall: 0.779817, ndcg: 0.646071
2023-11-27 19:19:25, Top_2, Test: recall: 0.816514, ndcg: 0.687847
2023-11-27 19:19:25, Top_3, Val:  recall: 0.853211, ndcg: 0.682768
2023-11-27 19:19:25, Top_3, Test: recall: 0.889908, ndcg: 0.724544
2023-11-27 19:19:25, Top_4, Val:  recall: 0.894495, ndcg: 0.700548
2023-11-27 19:19:25, Top_4, Test: recall: 0.931193, ndcg: 0.742325
2023-11-27 19:19:25, Top_5, Val:  recall: 0.908257, ndcg: 0.705872
2023-11-27 19:19:25, Top_5, Test: recall: 0.940367, ndcg: 0.745874
2023-11-27 19:19:25, Best in epoch 6, TOP 1: REC_V=0.41743, NDCG_V=0.41743
2023-11-27 19:19:25, Best in epoch 6, TOP 1: REC_T=0.46789, NDCG_T=0.46789
2023-11-27 19:19:25, Best in epoch 6, TOP 2: REC_V=0.77982, NDCG_V=0.64607
2023-11-27 19:19:25, Best in epoch 6, TOP 2: REC_T=0.81651, NDCG_T=0.68785
2023-11-27 19:19:25, Best in epoch 6, TOP 3: REC_V=0.85321, NDCG_V=0.68277
2023-11-27 19:19:25, Best in epoch 6, TOP 3: REC_T=0.88991, NDCG_T=0.72454
2023-11-27 19:19:25, Best in epoch 6, TOP 4: REC_V=0.89450, NDCG_V=0.70055
2023-11-27 19:19:25, Best in epoch 6, TOP 4: REC_T=0.93119, NDCG_T=0.74232
2023-11-27 19:19:25, Best in epoch 6, TOP 5: REC_V=0.90826, NDCG_V=0.70587
2023-11-27 19:19:25, Best in epoch 6, TOP 5: REC_T=0.94037, NDCG_T=0.74587
2023-11-27 19:19:27, Top_1, Val:  recall: 0.422018, ndcg: 0.422018
2023-11-27 19:19:27, Top_1, Test: recall: 0.472477, ndcg: 0.472477
2023-11-27 19:19:27, Top_2, Val:  recall: 0.798165, ndcg: 0.659341
2023-11-27 19:19:27, Top_2, Test: recall: 0.830275, ndcg: 0.698223
2023-11-27 19:19:27, Top_3, Val:  recall: 0.862385, ndcg: 0.691451
2023-11-27 19:19:27, Top_3, Test: recall: 0.894495, ndcg: 0.730333
2023-11-27 19:19:27, Top_4, Val:  recall: 0.903670, ndcg: 0.709231
2023-11-27 19:19:27, Top_4, Test: recall: 0.926606, ndcg: 0.744162
2023-11-27 19:19:27, Top_5, Val:  recall: 0.926606, ndcg: 0.718104
2023-11-27 19:19:27, Top_5, Test: recall: 0.940367, ndcg: 0.749485
2023-11-27 19:19:27, Best in epoch 7, TOP 1: REC_V=0.42202, NDCG_V=0.42202
2023-11-27 19:19:27, Best in epoch 7, TOP 1: REC_T=0.47248, NDCG_T=0.47248
2023-11-27 19:19:27, Best in epoch 7, TOP 2: REC_V=0.79817, NDCG_V=0.65934
2023-11-27 19:19:27, Best in epoch 7, TOP 2: REC_T=0.83028, NDCG_T=0.69822
2023-11-27 19:19:27, Best in epoch 7, TOP 3: REC_V=0.86239, NDCG_V=0.69145
2023-11-27 19:19:27, Best in epoch 7, TOP 3: REC_T=0.89450, NDCG_T=0.73033
2023-11-27 19:19:27, Best in epoch 7, TOP 4: REC_V=0.90367, NDCG_V=0.70923
2023-11-27 19:19:27, Best in epoch 7, TOP 4: REC_T=0.92661, NDCG_T=0.74416
2023-11-27 19:19:27, Best in epoch 7, TOP 5: REC_V=0.92661, NDCG_V=0.71810
2023-11-27 19:19:27, Best in epoch 7, TOP 5: REC_T=0.94037, NDCG_T=0.74949
2023-11-27 19:19:29, Top_1, Val:  recall: 0.403670, ndcg: 0.403670
2023-11-27 19:19:29, Top_1, Test: recall: 0.486239, ndcg: 0.486239
2023-11-27 19:19:29, Top_2, Val:  recall: 0.807339, ndcg: 0.658357
2023-11-27 19:19:29, Top_2, Test: recall: 0.844037, ndcg: 0.711984
2023-11-27 19:19:29, Top_3, Val:  recall: 0.871560, ndcg: 0.690467
2023-11-27 19:19:29, Top_3, Test: recall: 0.889908, ndcg: 0.734920
2023-11-27 19:19:29, Top_4, Val:  recall: 0.903670, ndcg: 0.704296
2023-11-27 19:19:29, Top_4, Test: recall: 0.931193, ndcg: 0.752700
2023-11-27 19:19:29, Top_5, Val:  recall: 0.922018, ndcg: 0.711394
2023-11-27 19:19:29, Top_5, Test: recall: 0.940367, ndcg: 0.756249
2023-11-27 19:19:31, Top_1, Val:  recall: 0.403670, ndcg: 0.403670
2023-11-27 19:19:31, Top_1, Test: recall: 0.490826, ndcg: 0.490826
2023-11-27 19:19:31, Top_2, Val:  recall: 0.798165, ndcg: 0.652569
2023-11-27 19:19:31, Top_2, Test: recall: 0.834862, ndcg: 0.707889
2023-11-27 19:19:31, Top_3, Val:  recall: 0.880734, ndcg: 0.693853
2023-11-27 19:19:31, Top_3, Test: recall: 0.894495, ndcg: 0.737705
2023-11-27 19:19:31, Top_4, Val:  recall: 0.912844, ndcg: 0.707682
2023-11-27 19:19:31, Top_4, Test: recall: 0.935780, ndcg: 0.755485
2023-11-27 19:19:31, Top_5, Val:  recall: 0.922018, ndcg: 0.711231
2023-11-27 19:19:31, Top_5, Test: recall: 0.949541, ndcg: 0.760809
2023-11-27 19:19:31, Best in epoch 9, TOP 1: REC_V=0.40367, NDCG_V=0.40367
2023-11-27 19:19:31, Best in epoch 9, TOP 1: REC_T=0.49083, NDCG_T=0.49083
2023-11-27 19:19:31, Best in epoch 9, TOP 2: REC_V=0.79817, NDCG_V=0.65257
2023-11-27 19:19:31, Best in epoch 9, TOP 2: REC_T=0.83486, NDCG_T=0.70789
2023-11-27 19:19:31, Best in epoch 9, TOP 3: REC_V=0.88073, NDCG_V=0.69385
2023-11-27 19:19:31, Best in epoch 9, TOP 3: REC_T=0.89450, NDCG_T=0.73771
2023-11-27 19:19:31, Best in epoch 9, TOP 4: REC_V=0.91284, NDCG_V=0.70768
2023-11-27 19:19:31, Best in epoch 9, TOP 4: REC_T=0.93578, NDCG_T=0.75549
2023-11-27 19:19:31, Best in epoch 9, TOP 5: REC_V=0.92202, NDCG_V=0.71123
2023-11-27 19:19:31, Best in epoch 9, TOP 5: REC_T=0.94954, NDCG_T=0.76081
2023-11-27 19:19:32, Top_1, Val:  recall: 0.403670, ndcg: 0.403670
2023-11-27 19:19:32, Top_1, Test: recall: 0.481651, ndcg: 0.481651
2023-11-27 19:19:32, Top_2, Val:  recall: 0.788991, ndcg: 0.646780
2023-11-27 19:19:32, Top_2, Test: recall: 0.830275, ndcg: 0.701609
2023-11-27 19:19:32, Top_3, Val:  recall: 0.876147, ndcg: 0.690358
2023-11-27 19:19:32, Top_3, Test: recall: 0.922018, ndcg: 0.747480
2023-11-27 19:19:32, Top_4, Val:  recall: 0.903670, ndcg: 0.702212
2023-11-27 19:19:32, Top_4, Test: recall: 0.940367, ndcg: 0.755382
2023-11-27 19:19:32, Top_5, Val:  recall: 0.931193, ndcg: 0.712859
2023-11-27 19:19:32, Top_5, Test: recall: 0.954128, ndcg: 0.760706
2023-11-27 19:19:34, Top_1, Val:  recall: 0.412844, ndcg: 0.412844
2023-11-27 19:19:34, Top_1, Test: recall: 0.467890, ndcg: 0.467890
2023-11-27 19:19:34, Top_2, Val:  recall: 0.775229, ndcg: 0.641484
2023-11-27 19:19:34, Top_2, Test: recall: 0.834862, ndcg: 0.699424
2023-11-27 19:19:34, Top_3, Val:  recall: 0.871560, ndcg: 0.689649
2023-11-27 19:19:34, Top_3, Test: recall: 0.917431, ndcg: 0.740708
2023-11-27 19:19:34, Top_4, Val:  recall: 0.908257, ndcg: 0.705453
2023-11-27 19:19:34, Top_4, Test: recall: 0.940367, ndcg: 0.750586
2023-11-27 19:19:34, Top_5, Val:  recall: 0.926606, ndcg: 0.712552
2023-11-27 19:19:34, Top_5, Test: recall: 0.958716, ndcg: 0.757684
{'data_path': './datasets', 'batch_size_train': 128, 'batch_size_test': 128, 'topk': [1, 2, 3, 4, 5], 'neg_num': 1, 'aug_type': 'ED', 'ed_interval': 1, 'embedding_sizes': [64], 'num_layerss': [1], 'item_level_ratios': [0.2], 'bundle_level_ratios': [0.2], 'bundle_agg_ratios': [0.2], 'self_loop': False, 'lrs': [0.001], 'l2_regs': [0.0001], 'c_lambdas': [0.01], 'c_temps': [0.25], 'epochs': 30, 'UI_layers': [0.7, 0.3], 'seed': 2023, 'UB_coefs': [1, 1], 'UI_coefs': [1, 1], 'BI_coefs': [1, 1], 'sep': '\t', 'file_type': '.txt', 'topk_valid': 3, 'nhead': 3, 'extra_layer': True, 'dataset': 'food', 'model': 'CrossCBR', 'gpu': '0', 'info': '', 'num_users': 879, 'num_bundles': 1784, 'num_items': 3767, 'w1': 1.0, 'w2': 1.0, 'w3': 0.1, 'w4': 0.1, 'sw': 0.9, 'nw': 0.1, 'device': device(type='cpu'), 'l2_reg': 0.0001, 'embedding_size': 64, 'item_level_ratio': 0.2, 'bundle_level_ratio': 0.2, 'bundle_agg_ratio': 0.2, 'num_layers': 1, 'c_lambda': 0.01, 'c_temp': 0.25}
2023-11-27 19:45:25, Top_1, Val:  recall: 0.110092, ndcg: 0.110092
2023-11-27 19:45:25, Top_1, Test: recall: 0.110092, ndcg: 0.110092
2023-11-27 19:45:25, Top_2, Val:  recall: 0.220183, ndcg: 0.179552
2023-11-27 19:45:25, Top_2, Test: recall: 0.211009, ndcg: 0.173764
2023-11-27 19:45:25, Top_3, Val:  recall: 0.284404, ndcg: 0.211662
2023-11-27 19:45:25, Top_3, Test: recall: 0.279817, ndcg: 0.208167
2023-11-27 19:45:25, Top_4, Val:  recall: 0.307339, ndcg: 0.221540
2023-11-27 19:45:25, Top_4, Test: recall: 0.344037, ndcg: 0.235825
2023-11-27 19:45:25, Top_5, Val:  recall: 0.353211, ndcg: 0.239285
2023-11-27 19:45:25, Top_5, Test: recall: 0.385321, ndcg: 0.251796
2023-11-27 19:45:25, Best in epoch 0, TOP 1: REC_V=0.11009, NDCG_V=0.11009
2023-11-27 19:45:25, Best in epoch 0, TOP 1: REC_T=0.11009, NDCG_T=0.11009
2023-11-27 19:45:25, Best in epoch 0, TOP 2: REC_V=0.22018, NDCG_V=0.17955
2023-11-27 19:45:25, Best in epoch 0, TOP 2: REC_T=0.21101, NDCG_T=0.17376
2023-11-27 19:45:25, Best in epoch 0, TOP 3: REC_V=0.28440, NDCG_V=0.21166
2023-11-27 19:45:25, Best in epoch 0, TOP 3: REC_T=0.27982, NDCG_T=0.20817
2023-11-27 19:45:25, Best in epoch 0, TOP 4: REC_V=0.30734, NDCG_V=0.22154
2023-11-27 19:45:25, Best in epoch 0, TOP 4: REC_T=0.34404, NDCG_T=0.23583
2023-11-27 19:45:25, Best in epoch 0, TOP 5: REC_V=0.35321, NDCG_V=0.23929
2023-11-27 19:45:25, Best in epoch 0, TOP 5: REC_T=0.38532, NDCG_T=0.25180
{'data_path': './datasets', 'batch_size_train': 128, 'batch_size_test': 128, 'topk': [1, 2, 3, 4, 5], 'neg_num': 1, 'aug_type': 'ED', 'ed_interval': 1, 'embedding_sizes': [64], 'num_layerss': [1], 'item_level_ratios': [0.2], 'bundle_level_ratios': [0.2], 'bundle_agg_ratios': [0.2], 'self_loop': False, 'lrs': [0.001], 'l2_regs': [0.0001], 'c_lambdas': [0.01], 'c_temps': [0.25], 'epochs': 30, 'UI_layers': [0.7, 0.3], 'seed': 2023, 'UB_coefs': [1, 1], 'UI_coefs': [1, 1], 'BI_coefs': [1, 1], 'sep': '\t', 'file_type': '.txt', 'topk_valid': 3, 'nhead': 3, 'extra_layer': True, 'dataset': 'food', 'model': 'CrossCBR', 'gpu': '0', 'info': '', 'num_users': 879, 'num_bundles': 1784, 'num_items': 3767, 'w1': 1.0, 'w2': 1.0, 'w3': 0.1, 'w4': 0.1, 'sw': 0.9, 'nw': 0.1, 'device': device(type='cpu'), 'l2_reg': 0.0001, 'embedding_size': 64, 'item_level_ratio': 0.2, 'bundle_level_ratio': 0.2, 'bundle_agg_ratio': 0.2, 'num_layers': 1, 'c_lambda': 0.01, 'c_temp': 0.25}
2023-11-27 19:46:17, Top_1, Val:  recall: 0.110092, ndcg: 0.110092
2023-11-27 19:46:17, Top_1, Test: recall: 0.110092, ndcg: 0.110092
2023-11-27 19:46:17, Top_2, Val:  recall: 0.220183, ndcg: 0.179552
2023-11-27 19:46:17, Top_2, Test: recall: 0.211009, ndcg: 0.173764
2023-11-27 19:46:17, Top_3, Val:  recall: 0.284404, ndcg: 0.211662
2023-11-27 19:46:17, Top_3, Test: recall: 0.279817, ndcg: 0.208167
2023-11-27 19:46:17, Top_4, Val:  recall: 0.307339, ndcg: 0.221540
2023-11-27 19:46:17, Top_4, Test: recall: 0.344037, ndcg: 0.235825
2023-11-27 19:46:17, Top_5, Val:  recall: 0.353211, ndcg: 0.239285
2023-11-27 19:46:17, Top_5, Test: recall: 0.385321, ndcg: 0.251796
2023-11-27 19:46:17, Best in epoch 0, TOP 1: REC_V=0.11009, NDCG_V=0.11009
2023-11-27 19:46:17, Best in epoch 0, TOP 1: REC_T=0.11009, NDCG_T=0.11009
2023-11-27 19:46:17, Best in epoch 0, TOP 2: REC_V=0.22018, NDCG_V=0.17955
2023-11-27 19:46:17, Best in epoch 0, TOP 2: REC_T=0.21101, NDCG_T=0.17376
2023-11-27 19:46:17, Best in epoch 0, TOP 3: REC_V=0.28440, NDCG_V=0.21166
2023-11-27 19:46:17, Best in epoch 0, TOP 3: REC_T=0.27982, NDCG_T=0.20817
2023-11-27 19:46:17, Best in epoch 0, TOP 4: REC_V=0.30734, NDCG_V=0.22154
2023-11-27 19:46:17, Best in epoch 0, TOP 4: REC_T=0.34404, NDCG_T=0.23583
2023-11-27 19:46:17, Best in epoch 0, TOP 5: REC_V=0.35321, NDCG_V=0.23929
2023-11-27 19:46:17, Best in epoch 0, TOP 5: REC_T=0.38532, NDCG_T=0.25180
